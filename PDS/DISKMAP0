*                                                                       00001
*DESCRIPTION        -         DISKMAP FOR ALL DASD DEVICES.             00002
*                                                                       00003
*CONTACT            -         GARY D. FROEMEL                           00004
*                             JOHNS-MANVILLE                            00005
*                             KEN-CARYL RANCH                           00006
*                             P.O. BOX 5108                             00007
*                             DENVER,COLO.  80217                       00008
*TELEPHONE          -         303-979-1000                              00009
*                                                                       00010
********************** C B T **************************************     00011
*  A USER OF THIS CODE DECIDED TO USE A PARM OF RESET, WHICH WILL *     00012
*  RESET THE HIGH WATER MARK IN THE VTOC. IT DID ALRIGHT BUT IT   *     00013
*  SET IT TO 512 (ON A 3350) AND THE ARM BOUNCED ALL OVER THE     *     00014
*  PLACE. BE CAREFUL !!!!!!!!                                     *     00015
********************** C B T ***************************************    00016
*                                                                       00017
*FUNCTION -DIRECT ACCESS VOLUME LISTING UTILITY.                        00018
*          IT WILL PRODUCE A LISTING OF EVERY DATASET ON A VOLUME       00019
*          PLUS CALCULATE THE FREE SPACE, FREE DSCBS ETC. OPTIONALLY    00020
*          VIA PARM INFORMATION IT WILL PRODUCE THE FOLLOWING:          00021
*         PARM='MAP     - PRODUCE A TRACK MAP OF VOLUME.                00022
*         PARM='PDS     - LIST ALL PDS DIRECTORIES ON VOLUME.           00023
*         PARM='ISAM    - LIST ISAM REORG ONFORMATION FOR DATASETS.     00024
*         PARM='EXT     - LIST THE EXTENTS OF THE DATASETS.             00025
*         PARM='DUMP    - LIST IN HEX ALL DSCBS ON VOLUME.              00026
*         PARM='EMPTY   - LIST ONLY DATASETS THAT ARE EMPTY.            00027
*         PARM='MODEL   - WILL ONLY LIST MODEL DSCBS.                   00028
*         PARM='SDUMP   - LIST IN HEX FORMAT 4 AND 5 DSCBS.             00029
*         PARM='VOLS    - ONLY USE DDNAMES OF VOLUMEXX    .             00030
*         PARM='JDATE   - LIST CREATION/EXPIRATION DATES IN JULIAN.     00031
*         PARM='NCP     - NUMBER OF CHANNEL PGMS USED TO READ VTOC.     00032
*         PARM='RESET   - RESET THE HIGH WATER MARK IN FORMAT 4 DSCB.   00033
*         PARM='DEBUG   - BYPASS THE ABEND ON ERROR CONDITIONS.         00034
*         PARM='LINECNT - USE OTHER THAN THE DEFAULT LINE COUNT.        00035
*         PARM='LSTDT   - DISPLAY LAST USE DATE AND USE COUNT.          00036
*                                                                       00037
******     OTHER COMMENT ARE DOCUMENTED IN BEGINING OF SOURCE.          00038
******     NOTE - SYS1.AMODGEN MUST BE CONCATENATED TO MACLIB FOR ASMB  00039
*                                                                       00040
DISKMAP  TITLE '... MACROS NOT FOUND IN SYS1.AMODGEN....'               00041
*--------------MODIFICATION.LOG---------------------------------------* 00042
*  PROGRAMMER  |  DATE  |  SUMMARY OF CHANGES MADE TO THIS PROGRAM    * 00044
*--------------+--------+---------------------------------------------* 00045
* J.MARTIN     |02/10/80| JM#1 - ADDED SUPPORT FOR SOME ASM2 FIELDS.  * 00046
*              |        |                                             * 00047
* J.MARTIN     |08/13/82| JM#2 - ADDED ENTERY IN THE DEVICE TABLE TO  * 00048
*              |        |        SUPPORT 3380 DEVICES.                * 00049
*              |        |                                             * 00047
*---------------------------------------------------------------------* 00093
         EJECT                                                          00094
         MACRO                                                          00095
         IEZCOM                                                         00096
COMECBPT DS    F    ADDRESS OF THE ECB FOR STARTED TASK                 00097
COMCIBPT DS    F    ADDRESS OF THE START OF THE CIB CHAIN FOR THIS TASK 00098
         MEND                                                           00099
         SPACE 3                                                        00100
         MACRO                                                          00101
         IEZCIB                                                         00102
         DS    0D                                                       00103
CIBNEXT  DS    A    NEXT CIB                                            00104
CIBVERB  DS    C                                                        00105
*                                                                       00106
CIBSTART EQU   X'04'                                                    00107
CIBMODFY EQU   X'44'                                                    00108
CIBSTOP  EQU   X'40'                                                    00109
CIBMOUNT EQU   X'0C'                                                    00110
*                                                                       00111
CIBLEN   DS    FL1                                                      00112
         DS    XL4  RESERVED                                            00113
CIBASID  DS    0H  ADDRESS SPACE ID..VS2                                00114
CIBTJID  DS    CL2  TSO JID                                             00115
CIBCONID DS    C  CONSOLE ID ISSUING COMM                               00116
         DS    X  RESERVED                                              00117
CIBDATLN DS    H                                                        00118
CIBDATA  DS    CL8                                                      00119
         MEND                                                           00120
         TITLE  '... DIRECT ACCESS VOLUME LISTER ...'                   00121
DISKMAP  START 0                                                        00122
         SPACE 1                                                        00123
*                                                                       00124
* WHEN ASSEMBLING DISKMAP SYS1.AMODGEN MUST BE CONCATENATED TO          00125
* SYS1.MACLIB.                                                          00126
*                                                                       00127
* WHEN LINKEDITING DISKMAP IT MUST BE AUTHORIZED (SETCODE AC=1) AND BE  00128
* PLACED IN AN AUTHORIZED LIBRARY.  I.E. LNKLST00 LIBRARY               00129
* USE FOLLOWING JCL TO EXECUTE DISKMAP                                  00130
* //STEP EXEC PGM=DISKMAP,REGION=1024K (1024K FOR LARGE VTOCS)          00131
* //SYSPRINT DD SYSOUT=A                                                00132
* //ANYNAME DD UNIT=WHATEVER,VOL=SER=WHATEVER,DISP=OLD (DISKMAP WILL    00133
* LIST ANY DDCARD IN STEP EXCEPT FOR RESERVED DDNAMES SUCH AS STEPLIB,  00134
* STEPCAT ETC. AS MANY DDCARDS CAN BE INCLUDED AS NEEDED                00135
*                                                                       00136
* REFER TO THE SYSPRINT OUTPUT LISTINGS FOR PARM INFORMATION.           00137
* PARM INFORMATION DOESNOT HAVE TO BE SPECIFIED.                        00138
*                                                                       00139
* DISKMAP WILL WORK ON MVS,SVS,VS1,MVT,MFT,PCP OPERATING SYSTEMS        00140
* IT ALSO SUPPORTS 3350S AS OF 01/77                                    00141
* IT ALSO SUPPORTS 3380S AS OF 08/82 -- J.MARTIN                        00142
*                                                                       00143
R0       EQU   0                   WORK                                 00144
R1       EQU   1                   WORK                                 00145
R2       EQU   2                   WORK                                 00146
R3       EQU   3                   WORK                                 00147
R4       EQU   4                   WORK                                 00148
R5       EQU   5                   WORK                                 00149
R6       EQU   6                   -> FM1, FM4 DSCB, PDS ENTRY          00150
R7       EQU   7                   -> FM2 DSCB, IF ANY                  00151
R8       EQU   8                   -> FM3, FM5 DSCB, IF ANY             00152
R9       EQU   9                   BASE REG 1                           00153
R10      EQU   10                  BASE REG 2                           00154
R11      EQU   11                  BASE REG 3                           00155
R12      EQU   12                  BASE REG 4                           00156
R13      EQU   13                  -> SAVE AREA                         00157
R14      EQU   14                  LINK, WORK                           00158
R15      EQU   15                  WORK                                 00159
         SPACE 1                                                        00160
SPACE0AP EQU   X'01'                                                    00161
SPACE1AP EQU   X'09'                                                    00162
SPACE2AP EQU   X'11'                                                    00163
SPACE3AP EQU   X'19'                                                    00164
EJECTAP  EQU   X'89'                                                    00165
SPACE0IM EQU   X'03'                                                    00166
SPACE1IM EQU   X'0B'                                                    00167
SPACE2IM EQU   X'13'                                                    00168
SPACE3IM EQU   X'1B'                                                    00169
EJECTIM  EQU   X'8B'                                                    00170
         SPACE 1                                                        00171
DEBUCBAD EQU   32                                                       00172
CAMLSTLN EQU   148                                                      00173
PDSBLKLN EQU   264                                                      00174
NCPDFLT  EQU   10                                                       00175
UTILPRIV EQU   5                                                        00176
OPERPRIV EQU   9                                                        00177
         SPACE 1                                                        00178
EMPTYOPT EQU   X'80'                                                    00179
LSTDTOPT EQU   X'40'                                                    00180
DUMPOPT  EQU   X'20'                                                    00181
SDUMPOPT EQU   X'10'                                                    00182
MAPOPT   EQU   X'08'                                                    00183
PDSOPT   EQU   X'04'                                                    00184
EXTNTOPT EQU   X'02'                                                    00185
DIRFLAG  EQU   X'01'                                                    00186
         SPACE 1                                                        00187
VOLSOPT  EQU   X'80'                                                    00188
LNCNTOPT EQU   X'40'                                                    00189
DEBUGOPT EQU   X'20'                                                    00190
RESETOPT EQU   X'10'                                                    00191
NCPOPT   EQU   X'08'                                                    00192
ISAMOPT  EQU   X'04'                                                    00193
JDATEOPT EQU   X'02'                                                    00194
MODELOPT EQU   X'01'                                                    00195
         EJECT                                                          00196
         SPACE 5                                                        00197
         SAVE  (14,12),,*                                               00198
         LR    R9,R15                                                   00199
         USING DISKMAP,R9                                               00200
         LM    R10,R12,BASEVALS                                         00201
         USING DISKMAP,R9,R10,R11,R12                                   00202
         SPACE 1                                                        00203
         LR    R2,R13                                                   00204
         LA    R13,SAVEAREA                                             00205
         ST    R2,SAVEAREA+4                                            00206
         ST    R13,8(,R2)                                               00207
         SR    R2,R2                                                    00208
         SPM   R2                                                       00209
         B     INIT                                                     00210
         SPACE 1                                                        00211
BASEVALS DC    A(DISKMAP+X'1000',DISKMAP+X'2000',DISKMAP+X'3000')       00212
         EJECT ,                                                        00213
         SPACE 3                                                        00214
NEXTVOL  BAL   R14,FREECORE                                             00215
         XC    START0(LENGTH0),START0 WHOLESALE ZEROING OF CORE         00216
         SR    R0,R0                                                    00217
         ST    R0,BUFPTR                                                00218
         MVC   CURLINES,=H'999'                                         00219
         MVI   HEADER,C' '                                              00220
         MVC   HEADER+1(L'HEADER-1),HEADER                              00221
         LA    R1,LASTDS1                                               00222
         ST    R1,FIRSTDS1                                              00223
         LA    R1,HOOKSTRT                                              00224
         ST    R1,HOOKSTRT                                              00225
         MVC   HWMDS1,EFFS                                              00226
         NI    PARMOPT1,255-DIRFLAG                                     00227
         SPACE 1                                                        00228
NEXTDD   TM    PARMOPT2,VOLSOPT                                         00229
         BO    NEXTDDCV                                                 00230
         L     R1,DDLSTPTR                                              00231
         LTR   R1,R1                                                    00232
         BZ    TIOTADV                                                  00233
         LH    R0,DDNAMLEN                                              00234
         SH    R0,=H'8'                                                 00235
         BM    RETURN                                                   00236
         STH   R0,DDNAMLEN                                              00237
         MVC   VOLDDNAM,0(R1)                                           00238
         LA    R1,8(R1)                                                 00239
         ST    R1,DDLSTPTR                                              00240
         B     NMAPSTRT                                                 00241
         SPACE 1                                                        00242
TIOTADV  L     R1,TIOTADDD                                              00243
         USING TIOENTRY,R1                                              00244
         SR    R0,R0                                                    00245
         IC    R0,TIOELNGH                                              00246
         LTR   R0,R0                                                    00247
         BZ    RETURN                                                   00248
         MVC   VOLDDNAM,TIOEDDNM                                        00249
         AR    R1,R0                                                    00250
         ST    R1,TIOTADDD                                              00251
         DROP  R1                                                       00252
         SPACE 1                                                        00253
NMAPSTRT LA    R0,8                                                     00254
         LA    R1,NOMAPDDS                                              00255
         CLC   VOLDDNAM(5),=C'SYS00'   CHECK FOR DAIR DDNAME  P.A.S.    00256
*        **** THIS IS CAUSED BY DAIR FOR THE CVOL CATALOG ***P.A.S.     00257
         BE    NEXTDD      IF FOUND, DO NOT MAP THIS VOL                00258
NMAPSRCH CLC   VOLDDNAM,0(R1)                                           00259
         BE    NOMAPFND                                                 00260
         BXH   R1,R0,NMAPSRCH                                           00261
         SPACE 1                                                        00262
NOMAPFND LA    R0,VOLDDNAM                                              00263
         CR    R0,R1                                                    00264
         BNE   NEXTDD                                                   00265
         B     TYPEDEV                                                  00266
         SPACE 1                                                        00267
NEXTDDCV LH    R0,CURVOL                                                00268
         CH    R0,NUMVOLS                                               00269
         BNL   RETURN                                                   00270
         AH    R0,=H'1'                                                 00271
         STH   R0,CURVOL                                                00272
         BAL   R14,CONVERT                                              00273
         MVC   CURVOLNM,CONVUNPK+10                                     00274
         SPACE 1                                                        00275
TYPEDEV  DEVTYPE VOLDDNAM,DEVTYPE,DEVTAB,RPS                            00276
         BXH   R15,R15,ERRNODD                                          00277
         CLI   DEVTYPE+2,UCB3DACC                                       00278
         BNE   ERRNOTDA                                                 00279
         SPACE 1                                                        00280
         MVC   DEVTABND,DEVTYPE+3                                       00281
         LA    R0,DEVENTLN                                              00282
         LA    R1,DEVTABLE                                              00283
DEVLOOP  CLC   DEVTABND(1),0(R1)                                        00284
         BE    DEVNTFND                                                 00285
         BXH   R1,R0,DEVLOOP                                            00286
         SPACE 1                                                        00287
DEVNTFND CLC   1(7,R1),DEVTABND+1                                       00288
         BE    ERRUNKDV                                                 00289
         ST    R1,DEVTABPT                                              00290
         SPACE 1                                                        00291
***** THIS SECTION WILL TELL THE DIFFERENCE BETWEEN THE 2 3340 MODELS.  00292
***** THE 3340 HAS 1 UCBTYPE FOR BOTH 35M/70M.                          00293
***** THIS SECTION WILL LOOK FOR THE X'015D' NUMBER OF CYLS....35M      00294
*****   ELSE THE NUMBER OF CYLS (70M) WILL BE X'02BA'...                00295
         SPACE 1                                                        00296
         CLI   DEVTYPE+3,X'0A'   TEST FOR A 3340-?                      00297
         BNE   RVDISK    IF NOT 3340...BYPASS                           00298
         CLC   DEVTYPE+8(2),=X'015D'    TEST FOR A 35M 3340 TYPE        00299
         BE    RVDISK   IF IT IS A 35MEG...NO NEED TO CHANGE DESC       00300
         MVC   6(2,R1),=C'70'   MOVE A "70M" ON DESC OF UNIT            00301
         SPACE 1                                                        00302
*** THIS SECTION WILL DETERMINE IF THE DISK IS REAL, OR MASS STORAGE    00303
         SPACE 1                                                        00304
RVDISK   TM    DEVTYPE+2,X'08'   TEST IF REAL/VIRT DASD                 00305
         BZ    DEVCON   BIT=0, REAL     BIT=1, VIRTUAL                  00306
         MVC   6(9,R1),=C'VIRT VOL.' MOVE "VIRT" DESC OF UNIT           00307
         SPACE 1                                                        00308
******** THIS SECTION WILL LOAD THE CONSTANTS FROM THE "DEVTYPE" TO     00309
********   BE USED BY THE HOMEMADE CCHHR CONVERT ROUTINES.....          00310
*                                                                       00311
DEVCON   MVC   DEVCONV2(2),DEVTYPE+10    LOW ORDER  CC                  00312
         MVC   DEVCONV1(1),DEVTYPE+11     HIGH ORDER CC                 00313
         MVI   DEVCONV1+1,X'00'      FINISH HIGH ORDER CC               00314
         MVC   DEVCONV3(2),=X'0000'   ZERO HIGH ORDER HH                00315
         MVC   DEVCONV4(2),=X'0001'   LOW ORDER  HH                     00316
         MVC   TRKSPCYL(2),DEVTYPE+10    TRKS/CYL                       00317
         SR    R1,R1                                                    00318
         LH    R1,DEVTYPE+8    LOAD  CYL PER VOLUME                     00319
         MH    R1,DEVTYPE+10   MULT "CYL/VOL" BY "TRKS/CYL"             00320
         STH   R1,TRKSPVOL    RESULT IS  "TRACKS/VOLUME"                00321
*                                                                       00322
         MVC   DCBDDNAM+(PDSDCB-IHADCB),VOLDDNAM                        00323
         MVC   DCBDDNAM+(VTOCDCB-IHADCB),VOLDDNAM                       00324
         SPACE 1                                                        00325
         RDJFCB MF=(E,OPENLIST)                                         00326
         TM    JFCBTSDM,X'20'                                           00327
         BO    ERRNOTDA                                                 00328
         MVI   JFCBDSNM,X'04'                                           00329
         MVC   JFCBDSNM+1(43),JFCBDSNM                                  00330
         OI    JFCBTSDM,X'08'                                           00331
         SPACE 1                                                        00332
         LH    R1,NCPPARM                                               00333
         SR    R0,R0                                                    00334
         IC    R0,JFCNCP                                                00335
         MVI   JFCNCP,0                                                 00336
         LTR   R0,R0                                                    00337
         BZ    SAVENCP                                                  00338
         LR    R1,R0                                                    00339
SAVENCP  ST    R1,RENCP                                                 00340
         OI    DCBOPTCD+(VTOCDCB-IHADCB),DCBOPTC                        00341
         CH    R1,=H'1'                                                 00342
         BNE   SETNCP                                                   00343
         SR    R1,R1                                                    00344
         NI    DCBOPTCD+(VTOCDCB-IHADCB),255-DCBOPTC                    00345
SETNCP   STC   R1,DCBNCP+(VTOCDCB-IHADCB)                               00346
         SPACE 1                                                        00347
         OPEN  TYPE=J,MF=(E,OPENLIST)                                   00348
         TM    DCBOFLGS+(VTOCDCB-IHADCB),DCBOFOPN                       00349
         BZ    ERRNOPEN                                                 00350
         L     R2,DCBDEBAD+(VTOCDCB-IHADCB)                             00351
         L     R2,DEBUCBAD(,R2)                                         00352
         SPACE 1                                                        00353
********  THIS SECTION DELETED    4/1/75    P.A.S.                      00354
********  IT WAS USED FOR DATA CELLS...NO LONGER SUPPORTED              00355
         SPACE 1                                                        00356
         USING UCBOB,R2                                                 00357
MAINUCB  MVC   VTOCTTR,UCBVTOC                                          00358
         MVC   VOLSERNO,UCBVOLI                                         00359
         MVC   VOLSTAT,UCBSTAT                                          00360
         MVC   HEAD1UCB,UCBNAME     MOVE EBCIDIC UCB ADDR FOR HEADN     00361
         TM    UCBSTAB,UCBBPUB    TEST FOR PUBLIC MOUNT                 00362
         BNO   *+10                                                     00363
         MVC   HEAD1MT,=C'PUBLIC  '                                     00364
         TM    UCBSTAB,UCBBPRV    TEST FOR PRIVATE                      00365
         BNO   *+10                                                     00366
         MVC   HEAD1MT,=C'PRIVATE '                                     00367
         TM    UCBSTAB,UCBBSTR   TEST FOR STORAGE                       00368
         BNO   *+10                                                     00369
         MVC   HEAD1MT,=C'STORAGE '                                     00370
         TM    UCBSTAB,UCBPGFL    TEST IF PAGING DEVIC                  00371
         BNO   *+10                                                     00372
         MVC   HEAD1MT,=C'*PAGING*'                                     00373
         TM    UCBSTAT,UCBSYSR    TEST FOR SYS-RES                      00374
         BNO   *+10                                                     00375
         MVC   HEAD1MT,=C'*SYSRES*'                                     00376
         SPACE 1                                                        00377
         MVC   HEAD1MTR,=C'REMOV'                                       00378
         TM    UCBSTAT,UCBRESV                                          00379
         BNO   *+10                                                     00380
         MVC   HEAD1MTR,=C'RSERV'                                       00381
         TM    UCBSTAT,UCBPRES                                          00382
         BNO   *+10                                                     00383
         MVC   HEAD1MTR,=C'RSDNT'                                       00384
         SPACE 1                                                        00385
COMONUCB ST    R2,UCBADDR                                               00386
         DROP  R2                                                       00387
         MVC   HEAD1VOL,VOLSERNO                                        00388
         MVC   HEADMID(81),HEAD1                                        00389
         SPACE 1                                                        00390
         ENQ   MF=(E,ENQVTOC)                                           00391
         NI    DEQGATE,X'0F'                                            00392
         SPACE 1                                                        00393
         LH    R1,VTOCTT                                                00394
         BAL   R14,TTCONVRT                                             00395
         MVC   VTOCCCHH,CCHH                                            00396
         MVI   VTDSCBTR+1,255                                           00397
         SPACE 1                                                        00398
         SR    R4,R4                                                    00399
         IC    R4,DCBKEYLE+(VTOCDCB-IHADCB)                             00400
         AH    R4,DCBBLKSI+(VTOCDCB-IHADCB)                             00401
         AH    R4,=H'20'                                                00402
         ST    R4,REBLKSIZ                                              00403
         L     R5,RENCP                                                 00404
         ST    R5,RECOUNT                                               00405
         LR    R1,R4                                                    00406
         MR    R0,R5                                                    00407
         LR    R0,R1                                                    00408
         ST    R0,REGETSIZ                                              00409
         GETMAIN EC,LV=(0),A=REBLOCK@                                   00410
         BXH   R15,R15,ERRNOCOR                                         00411
         L     R2,REBLOCK@                                              00412
         ST    R2,RENEXT@                                               00413
         LA    R3,VTOCDCB                                               00414
         SPACE 1                                                        00415
READINIT XC    0(20,R2),0(R2)                                           00416
         LA    R4,20(R2)                                                00417
         READ  (2),SF,(3),(4),MF=E                                      00418
         A     R2,REBLKSIZ                                              00419
         BCT   R5,READINIT                                              00420
         SPACE 1                                                        00421
         LA    R4,DS4LEN                                                00422
         BAL   R14,GETCORE                                              00423
         ST    R3,FMT4AD                                                00424
         LR    R6,R3                                                    00425
         USING DS4,R6                                                   00426
         BAL   R14,VTOCREAD                                             00427
         BAL   R14,ABDUMP                                               00428
         CLI   DS4IDFMT,C'4'                                            00429
         MVI   BADDSTYP,C'4'                                            00430
         LR    R8,R6                                                    00431
         BNE   ERRNOTFX                                                 00432
         MVI   FM4COUNT+1,1                                             00433
         TM    DS4VTOCI,X'04'                                           00434
         BZ    *+8                                                      00435
         OI    PARMOPT1,DIRFLAG                                         00436
         MVC   HOOKLCCH(20),HOOKINIT                                    00437
         LA    R2,HOOKPTR                                               00438
         BAL   R14,HOOKUP                                               00439
         SR    R0,R0                                                    00440
         IC    R0,DS4DEVDT                                              00441
         STH   R0,VTDSCBTR                                              00442
         TM    PARMOPT2,RESETOPT+DEBUGOPT                               00443
         BNZ   *+10                                                     00444
         MVC   HWMDS1,DS4HPCHR                                          00445
         MVC   HOOKLCCH(8),DS4VTOCE+2                                   00446
         LA    R2,DS4VTOCE                                              00447
         BAL   R14,F1EXTCNV                                             00448
         STH   R0,HOOKNTRK                                              00449
         STH   R0,VTOCSIZE                                              00450
         MVC   HOOKLOTT(4),LOWTT                                        00451
         MVI   HOOKTYPE,C'4'                                            00452
         MVC   HOOKSEQN,DS4VTOCE+1                                      00453
         MVC   HOOKIDPT,=A(VTOCMSG)                                     00454
         LA    R2,HOOKPTR                                               00455
         BAL   R14,HOOKUP                                               00456
         SPACE 1                                                        00457
         LA    R4,DS5LEN                                                00458
         BAL   R14,GETCORE                                              00459
         ST    R3,FMT5AD                                                00460
         LR    R8,R3                                                    00461
         USING DS5,R8                                                   00462
         BAL   R14,VTOCREAD                                             00463
         BAL   R14,ABDUMP                                               00464
         CLI   DS5FMTID,C'5'                                            00465
         MVI   BADDSTYP,C'5'                                            00466
         BNE   ERRNOTFX                                                 00467
         MVI   FM5COUNT+1,1                                             00468
         BAL   R14,F56HOOK                                              00469
         SR    R0,R0                                                    00470
         ST    R0,DS5F5PTR                                              00471
         DROP  R6,R8                                                    00472
         EJECT                                                          00473
         SPACE 3                                                        00474
NEXTFM1  LA    R4,DS1LEN                                                00475
         BAL   R14,GETCORE                                              00476
         LR    R6,R3                                                    00477
         USING DS1,R6                                                   00478
READFM1  BAL   R14,VTOCREAD                                             00479
         B     READFM5                                                  00480
         SR    R1,R1                                                    00481
         IC    R1,DS1FMTID                                              00482
         N     R1,=F'15'                                                00483
         CH    R1,=H'6'                                                 00484
         BNH   *+8                                                      00485
         BAL   R14,ABDUMP                                               00486
         SLL   R1,1                *2                                   00487
         LH    R2,FMXCOUNT(R1)                                          00488
         LA    R2,1(R2)                                                 00489
         STH   R2,FMXCOUNT(R1)                                          00490
         LTR   R1,R1                                                    00491
         BNZ   CHECKDS1                                                 00492
         CLI   HWMINDIC,1                                               00493
         BE    READFM1                                                  00494
         MVC   HWMNEW,DS1FDAD+3                                         00495
         MVI   HWMINDIC,1                                               00496
         B     READFM1                                                  00497
         SPACE 1                                                        00498
CHECKDS1 CLI   DS1FMTID,C'1'                                            00499
         BNE   READFM1                                                  00500
         MVC   HWMNEW,DS1FDAD+3                                         00501
         MVI   HWMINDIC,1                                               00502
         L     R2,FIRSTDS1                                              00503
         L     R3,=A(FIRSTDS1-(DS1F1PTR-DS1))                           00504
COMPFM1  CLC   DS1DSNAM,DS1DSNAM-DS1(R2)                                00505
         BL    INSRTFM1                                                 00506
         LR    R3,R2                                                    00507
         L     R2,DS1F1PTR-DS1(R2)                                      00508
         B     COMPFM1                                                  00509
INSRTFM1 ST    R2,DS1F1PTR                                              00510
         ST    R6,DS1F1PTR-DS1(R3)                                      00511
         SR    R0,R0                                                    00512
         ST    R0,DS1F3PTR                                              00513
         B     NEXTFM1                                                  00514
         SPACE 1                                                        00515
         DROP  R6                                                       00516
         EJECT                                                          00517
         SPACE 3                                                        00518
READFM5  BAL   R14,CLOSVTOC                                             00519
         L     R6,FMT4AD                                                00520
         USING DS4,R6                                                   00521
         L     R8,FMT5AD                                                00522
         USING DS5,R8                                                   00523
         B     CHECKFM5                                                 00524
         SPACE 1                                                        00525
NEXTFM5  LA    R4,DS5LEN                                                00526
         BAL   R14,GETCORE                                              00527
         ST    R3,DS5F5PTR                                              00528
         LA    R2,DS5PTRDS                                              00529
         LR    R8,R3                                                    00530
         BAL   R14,OBTAIN                                               00531
         CLI   DS5FMTID,C'5'                                            00532
         MVI   BADDSTYP,C'5'                                            00533
         BNE   ERRNOTFX                                                 00534
         BAL   R14,F56HOOK                                              00535
         SR    R0,R0                                                    00536
         ST    R0,DS5F5PTR                                              00537
CHECKFM5 CLC   DS5PTRDS,ZEROES                                          00538
         BNE   NEXTFM5                                                  00539
         SPACE 1                                                        00540
         CLC   DS4F6PTR,ZEROES                                          00541
         BE    READFM23                                                 00542
         LA    R4,DS6LEN                                                00543
         BAL   R14,GETCORE                                              00544
         ST    R3,FMT6AD                                                00545
         LA    R2,DS4F6PTR                                              00546
         SPACE 1                                                        00547
READFM6  LR    R8,R3                                                    00548
         USING DS6,R8                                                   00549
         BAL   R14,OBTAIN                                               00550
         CLI   DS6FMTID,C'6'                                            00551
         MVI   BADDSTYP,C'6'                                            00552
         BNE   ERRNOTFX                                                 00553
         BAL   R14,F56HOOK                                              00554
         SR    R3,R3                                                    00555
         ST    R3,DS6F6PTR                                              00556
         CLC   DS6PTRDS,ZEROES                                          00557
         BE    READFM23                                                 00558
         LA    R4,DS6LEN                                                00559
         BAL   R14,GETCORE                                              00560
         ST    R3,DS6F6PTR                                              00561
         LA    R2,DS6PTRDS                                              00562
         B     READFM6                                                  00563
         SPACE 1                                                        00564
         DROP  R6,R8                                                    00565
         EJECT ,                                                        00566
         SPACE 3                                                        00567
READFM23 L     R6,=A(FIRSTDS1-(DS1F1PTR-DS1))                           00568
         USING DS1,R6                                                   00569
NEXTFM23 L     R6,DS1F1PTR                                              00570
         CLC   DS1DSNAM,LASTDS1                                         00571
         BE    VTOCUPDT                                                 00572
         CLC   DS1PTRDS,ZEROES                                          00573
         BE    NEXTFM23                                                 00574
         SPACE 2                                                        00575
         LA    R4,DS3LEN                                                00576
         BAL   R14,GETCORE                                              00577
         LR    R8,R3                                                    00578
         USING DS3,R8                                                   00579
         LA    R2,DS1PTRDS                                              00580
         BAL   R14,OBTAIN                                               00581
         ST    R8,DS1F3PTR                                              00582
         SR    R0,R0                                                    00583
         ST    R0,DS3F2PTR                                              00584
         TM    DS1DSORG,DCBDSGIS                                        00585
         BNO   CHECKFM3                                                 00586
         USING DS2,R8                                                   00587
         CLI   DS2FMTID,C'2'                                            00588
         BNE   CHECKFM3                                                 00589
         CLC   DS2PTRDS,ZEROES                                          00590
         BE    NEXTFM23                                                 00591
         LA    R4,DS3LEN                                                00592
         BAL   R14,GETCORE                                              00593
         ST    R3,DS2F3PTR                                              00594
         LA    R2,DS2PTRDS                                              00595
         BAL   R14,OBTAIN                                               00596
         ST    R8,DS3F2PTR-DS3(,R3)                                     00597
         LR    R8,R3                                                    00598
         USING DS3,R8                                                   00599
         SPACE 1                                                        00600
CHECKFM3 CLI   DS3FMTID,C'3'                                            00601
         BE    NEXTFM23                                                 00602
         MVI   BADDSTYP,C'3'                                            00603
         B     ERRNOTFX                                                 00604
         SPACE 1                                                        00605
         DROP  R6,R8                                                    00606
         EJECT ,                                                        00607
         SPACE 1                                                        00608
VTOCUPDT TM    PARMOPT2,RESETOPT+DEBUGOPT                               00609
         BZ    VTOCPRT                                                  00610
         TM    PARMOPT1,DIRFLAG                                         00611
         BO    VTOCPRT                                                  00612
         OI    OPENFLAG,OPENUPDT                                        00613
         OPEN  TYPE=J,MF=(E,OPENLIST)                                   00614
         TM    DCBOFLGS+(VTOCDCB-IHADCB),DCBOFOPN                       00615
         BO    *+8                                                      00616
         BAL   R14,ABEND                                                00617
         NI    OPENFLAG,255-OPENUPDT                                    00618
         SPACE 1                                                        00619
VTOCUPRD READ  VTOCDECB,SF,MF=E                                         00620
         CHECK VTOCDECB                                                 00621
         LA    R1,=CL11'VTOC READ.'                                     00622
         BAL   R14,SYNADCHK                                             00623
         MVC   DS4FDAD+(CAMLIST-DS4),DCBFDAD+(VTOCDCB-IHADCB)           00624
         SPACE 1                                                        00625
         CLI   DS4IDFMT+(CAMLIST-DS4),C'4'                              00626
         MVI   BADDSTYP,C'4'                                            00627
         LA    R8,CAMLIST                                               00628
         BNE   ERRNOTFX                                                 00629
         MVC   HWMOLD,DS4HPCHR+(CAMLIST-DS4)                            00630
         MVC   DS4HPCHR+(CAMLIST-DS4),HWMNEW                            00631
         TM    PARMOPT2,DEBUGOPT                                        00632
         BO    VTOCUPCL                                                 00633
         SPACE 1                                                        00634
         WRITE VTOCDECB,SF,MF=E                                         00635
         CHECK VTOCDECB                                                 00636
         LA    R1,=CL11'VTOC WRITE.'                                    00637
         BAL   R14,SYNADCHK                                             00638
         L     R1,FMT4AD                                                00639
         MVC   0(DS4LEN,R1),CAMLIST                                     00640
         SPACE 1                                                        00641
VTOCUPCL CLOSE (VTOCDCB)                                                00642
         BAL   R14,DEQVTOC                                              00643
         SPACE 1                                                        00644
         MVC   BUF+1(31),=C'VTOC RESET INFO:  OLD FMT1 HWM='            00645
         TM    PARMOPT2,DEBUGOPT                                        00646
         BZ    *+10                                                     00647
         MVC   BUF+6(5),=C'DEBUG'                                       00648
         MVI   BUF+36,C'.'                                              00649
         MVI   BUF+41,C'.'                                              00650
         UNPK  TRAREA,HWMOLD(8)                                         00651
         TR    TRAREA,TRTABLE                                           00652
         MVC   BUF+32(4),TRAREA                                         00653
         MVC   BUF+37(4),TRAREA+4                                       00654
         MVC   BUF+42(2),TRAREA+8                                       00655
         SPACE 1                                                        00656
         MVC   BUF+47(13),=C'NEW FMT1 HWM='                             00657
         MVI   BUF+64,C'.'                                              00658
         MVI   BUF+69,C'.'                                              00659
         UNPK  TRAREA,HWMNEW(8)                                         00660
         TR    TRAREA,TRTABLE                                           00661
         MVC   BUF+60(4),TRAREA                                         00662
         MVC   BUF+65(4),TRAREA+4                                       00663
         MVC   BUF+70(2),TRAREA+8                                       00664
         MVI   BUF,SPACE3AP                                             00665
         BAL   R14,PRINT                                                00666
         EJECT                                                          00667
         SPACE 1                                                        00668
VTOCPRT  BAL   R14,DEQVTOC                                              00669
         L     R6,FMT4AD                                                00670
         USING DS4,R6                                                   00671
         SPACE 1                                                        00672
         MVC   BUF+1(19),=C'DEVICE DESCRIPTION:'                        00673
         MVC   BUF+22(5),=C'TYPE='                                      00674
         L     R2,DEVTABPT                                              00675
         MVC   BUF+27(15),1(R2)                                         00676
         SPACE 1                                                        00677
         MVC   BUF+44(7),=C'NOCYLS='                                    00678
         LA    R2,DS4DEVSZ                                              00679
         BAL   R14,CONVERT2                                             00680
         MVC   BUF+51(5),CONVERTD                                       00681
         SPACE 1                                                        00682
         MVC   BUF+58(9),=C'TRKS/CYL='                                  00683
         LA    R2,DS4DEVSZ+2                                            00684
         BAL   R14,CONVERT2                                             00685
         MVC   BUF+67(5),CONVERTD                                       00686
         SPACE 1                                                        00687
         MVC   BUF+74(8),=C'TRKSIZE='                                   00688
         LA    R2,DS4DEVTK                                              00689
         BAL   R14,CONVERT2                                             00690
         MVC   BUF+82(5),CONVERTD                                       00691
         SPACE 1                                                        00692
         MVC   BUF+89(12),=C'MAX BLKSIZE='                              00693
         LA    R2,DEVTYPE+6                                             00694
         BAL   R14,CONVERT2                                             00695
         MVC   BUF+101(5),CONVERTD                                      00696
         SPACE 1                                                        00697
         MVC   BUF+108(9),=C'DSCB/TRK='                                 00698
         LA    R2,DS4DEVDT                                              00699
         BAL   R14,CONVERT1                                             00700
         MVC   BUF+117(3),CONVERTD                                      00701
         SPACE 1                                                        00702
         MVC   BUF+122(8),=C'PDS/TRK='                                  00703
         LA    R2,DS4DEVDB                                              00704
         BAL   R14,CONVERT1                                             00705
         MVC   BUF+130(3),CONVERTD                                      00706
         MVI   BUF,SPACE2AP                                             00707
         BAL   R14,PRINT                                                00708
         SPACE 1                                                        00709
         MVC   BUF+1(11),=C'VTOC DESCR:'                                00710
         MVC   BUF+13(7),=C'R/W=0/0'                                    00711
         CLI   DS4SECLV,0                                               00712
         BE    VTPRDSCB                                                 00713
         UNPK  TRAREA,DS4SECLV(8)                                       00714
         TR    TRAREA,TRTABLE                                           00715
         MVC   BUF+17(1),TRAREA                                         00716
         MVC   BUF+19(1),TRAREA+1                                       00717
         SPACE 1                                                        00718
VTPRDSCB MVC   BUF+23(6),=C'DSCBS='                                     00719
         SR    R0,R0                                                    00720
         IC    R0,DS4DEVDT                                              00721
         MH    R0,VTOCSIZE                                              00722
         BAL   R14,CONVERT                                              00723
         MVC   BUF+29(5),CONVERTD                                       00724
         SPACE 1                                                        00725
         MVC   BUF+35(6),=C'AVAIL='                                     00726
         LA    R2,DS4DSREC                                              00727
         BAL   R14,CONVERT2                                             00728
         MVC   BUF+41(5),CONVERTD                                       00729
         SPACE 1                                                        00730
         MVC   BUF+47(9),=C'VTOC EXT='                                  00731
         MVI   BUF+60,C'.'                                              00732
         MVI   BUF+65,C'-'                                              00733
         MVI   BUF+70,C'.'                                              00734
         UNPK  TRAREA,DS4VTOCE+2(8)                                     00735
         TR    TRAREA,TRTABLE                                           00736
         MVC   BUF+56(4),TRAREA                                         00737
         MVC   BUF+61(4),TRAREA+4                                       00738
         UNPK  TRAREA,DS4VTOCE+6(8)                                     00739
         TR    TRAREA,TRTABLE                                           00740
         MVC   BUF+66(4),TRAREA                                         00741
         MVC   BUF+71(4),TRAREA+4                                       00742
         SPACE 1                                                        00743
         MVC   BUF+78(9),=C'FMT1 HWM='                                  00744
         MVI   BUF+91,C'.'                                              00745
         MVI   BUF+96,C'.'                                              00746
         UNPK  TRAREA,DS4HPCHR(8)                                       00747
         TR    TRAREA,TRTABLE                                           00748
         MVC   BUF+87(4),TRAREA                                         00749
         MVC   BUF+92(4),TRAREA+4                                       00750
         MVC   BUF+97(2),TRAREA+8                                       00751
         SPACE 1                                                        00752
         MVC   BUF+101(7),=C'NUMALT='                                   00753
         LA    R2,DS4NOATK                                              00754
         BAL   R14,CONVERT2                                             00755
         MVC   BUF+108(5),CONVERTD                                      00756
         SPACE 1                                                        00757
         LH    R2,TRKSPVOL              LOAD TRKS PER VOL TOTAL         00758
         SH    R2,DS4NOATK              SUBTRACT OFF ALTERNATES LEFT    00759
         STH   R2,TRKSPVOL              TOTAL PER VOL = OLD TOT - ALTS  00760
         SPACE 1                                                        00761
         MVC   BUF+114(8),=C'NEXTALT='                                  00762
         UNPK  TRAREA,DS4HCCHH(8)                                       00763
         TR    TRAREA,TRTABLE                                           00764
         MVC   BUF+122(4),TRAREA                                        00765
         MVI   BUF+126,C'.'                                             00766
         MVC   BUF+127(4),TRAREA+4                                      00767
         MVI   BUF,SPACE2AP                                             00768
         BAL   R14,PRINT                                                00769
         SPACE 1                                                        00770
         MVC   BUF+1(16),=C'AVAILABLE SPACE:'                           00771
         LH    R0,AVAILSPC                                              00772
         BAL   R14,CONVERT                                              00773
         MVC   BUF+18(5),CONVEDIT+7                                     00774
         SPACE 1                                                        00775
         MVC   BUF+24(9),=C'TRACKS IN'                                  00776
         LH    R0,AVAILEXT                                              00777
         BAL   R14,CONVERT                                              00778
         MVC   BUF+34(4),CONVEDIT+8                                     00779
         SPACE 1                                                        00780
         MVC   BUF+39(18),=C'EXTENTS, INCLUDING'                        00781
         LH    R0,AVAILCYL                                              00782
         BAL   R14,CONVERT                                              00783
         MVC   BUF+58(4),CONVEDIT+8                                     00784
         SPACE 1                                                        00785
         MVC   BUF+63(34),=C'FULL CYLINDERS.  LARGEST EXTENT IS'        00786
         LA    R2,F5LARGST                                              00787
         BAL   R14,CONVERT2                                             00788
         MVC   BUF+98(5),CONVEDIT+7                                     00789
         SPACE 1                                                        00790
         MVC   BUF+104(14),=C'CYLINDERS PLUS'                           00791
         LA    R2,F5LARGST+2                                            00792
         BAL   R14,CONVERT1                                             00793
         MVC   BUF+119(3),CONVEDIT+9                                    00794
         SPACE 1                                                        00795
         MVC   BUF+123(7),=C'TRACKS.'                                   00796
         MVI   BUF,SPACE2AP                                             00797
         BAL   R14,PRINT                                                00798
         SPACE 1                                                        00799
         TM    DS4VSAM,X'80'     TEST FOR VSAM OWNERSHIP BIT TURNED ON  00800
         BZ    NOVSAM            IF NOT ON....NOT OWNED BY VSAM         00801
         MVC   BUF+2(41),=C'*** THIS PACK IS OWNED BY A VSAM CATALOG '  00802
         MVI   BUF,SPACE2AP                                             00803
         BAL   R14,PRINT                                                00804
         CLC   DS4VTOCE+24(2),ZEROES      CHECK FOR A "CRA" POINTER     00805
         BE    NOVSAM      IF ZERO, NO POINTER....NO "CRA"              00806
         MVC   CRATRACK(2),DS4VTOCE+24  MOVE CRA ADDRESS FOR ALIGNMENT  00807
         MVC   BUF+2(41),=C'*** THIS PACK CONTAINS A C.R.A. AT TRACK:'  00808
         LH    R0,CRATRACK     LOAD UP 2 BYTE CRA ADDRESS               00809
         BAL   R14,CONVERT    GO CONVERT TO EBCIDIC                     00810
         MVC   BUF+43(5),CONVEDIT+7     MOVE TO PRINT LINE              00811
         MVI   BUF,SPACE2AP                                             00812
         BAL   R14,PRINT                                                00813
         SPACE 1                                                        00814
NOVSAM   EQU   *                                                        00815
         TM    PARMOPT1,DIRFLAG                                         00816
         BZ    NODIRFLG                                                 00817
         MVC   BUF+1(59),=C'*** WARNING - POSSIBLE VTOC ERRORS EXIST ONX00818
                THIS VOLUME ***'                                        00819
         MVI   BUF,SPACE2AP                                             00820
         BAL   R14,PRINT                                                00821
         SPACE 3                                                        00822
NODIRFLG TM    PARMOPT1,DUMPOPT+SDUMPOPT+DIRFLAG                        00823
         BZ    FM1PRINT                                                 00824
         SPACE 1                                                        00825
         LR    R2,R6                                                    00826
         LA    R3,DS4FDAD                                               00827
         BAL   R14,DUMPDSCB                                             00828
         SPACE 1                                                        00829
         L     R8,FMT5AD                                                00830
         USING DS5,R8                                                   00831
DMPF5TST LTR   R8,R8                                                    00832
         BZ    ENDUMPF5                                                 00833
         LR    R2,R8                                                    00834
         LA    R3,DS5FDAD                                               00835
         BAL   R14,DUMPDSCB                                             00836
         L     R8,DS5F5PTR                                              00837
         B     DMPF5TST                                                 00838
         SPACE 1                                                        00839
ENDUMPF5 L     R8,FMT6AD                                                00840
         USING DS6,R8                                                   00841
DMPF6TST LTR   R8,R8                                                    00842
         BZ    ENDUMPF6                                                 00843
         LR    R2,R8                                                    00844
         LA    R3,DS6FDAD                                               00845
         BAL   R14,DUMPDSCB                                             00846
         L     R8,DS6F6PTR                                              00847
         B     DMPF6TST                                                 00848
         SPACE 1                                                        00849
ENDUMPF6 MVI   BUF,SPACE2IM                                             00850
         BAL   R14,PRINT                                                00851
         SPACE 1                                                        00852
         DROP  R6,R8                                                    00853
         EJECT                                                          00854
FM1PRINT L     R6,=A(FIRSTDS1-(DS1F1PTR-DS1))                           00855
         USING DS1,R6                                                   00856
         LA    R1,HEAD1A                                                00857
         ST    R1,BUFPTR                                                00858
         PUT   PRINTDCB,HEADER1                                         00859
         PUT   PRINTDCB,HEADER2                                         00860
         LH    R0,CURLINES                                              00861
         AH    R0,=H'2'                                                 00862
         STH   R0,CURLINES                                              00863
         SPACE 2                                                        00864
FM1PRLOP L     R6,DS1F1PTR                                              00865
         CLC   DS1DSNAM,LASTDS1                                         00866
         BE    FM1PREND                                                 00867
         SR    R7,R7                                                    00868
         L     R8,DS1F3PTR                                              00869
         USING DS3,R8                                                   00870
         LTR   R8,R8                                                    00871
         BZ    FM1GOHK                                                  00872
         CLI   DS3FMTID,C'3'                                            00873
         BE    FM1GOHK                                                  00874
         LR    R7,R8                                                    00875
         USING DS2,R7                                                   00876
         L     R8,DS2F3PTR                                              00877
FM1GOHK  BAL   R14,F13HOOK                                              00878
         LA    R2,1                                                     00879
         TM    PARMOPT1,EXTNTOPT                                        00880
         BZ    FM1TSTIS                                                 00881
         LH    R1,NUMEXT                                                00882
         LA    R2,2(R1,R2)                                              00883
FM1TSTIS LTR   R7,R7                                                    00884
         BZ    FM1TSTDP                                                 00885
         TM    PARMOPT2,ISAMOPT                                         00886
         BZ    *+8                                                      00887
         AH    R2,=H'4'                                                 00888
FM1TSTDP TM    PARMOPT1,DUMPOPT                                         00889
         BZ    FM1LKAHD                                                 00890
         AH    R2,=H'4'                                                 00891
         LTR   R7,R7                                                    00892
         BZ    *+8                                                      00893
         AH    R2,=H'4'                                                 00894
         LTR   R8,R8                                                    00895
         BZ    FM1LKAHD                                                 00896
         AH    R2,=H'4'                                                 00897
FM1LKAHD BAL   R14,PRLKAHED                                             00898
         SPACE 1                                                        00899
         MVC   L1DSNAME,DS1DSNAM                                        00900
         SPACE 1                                                        00901
FM1VOLSR TM    PARMOPT1,LSTDTOPT                                   JM#1 00902
         BNZ   LSTUSDTE                                            JM#1 00903
         MVC   L1SERIAL(6),VOLSERNO                                JM#1 00904
         B     FM1SECUR                                            JM#1 00905
LSTUSDTE CLI   DS1SYSCD+13,X'00' OLD ASM2 FMT.                     JM#1 00906
         BNE   LSTUSDT1                                            JM#1 00907
         MVC   DS1DSSN+3(3),DS1SYSCD+14                            JM#1 00908
         B     LSTUSDT2                                            JM#1 00909
LSTUSDT1 MVC   DS1DSSN+3(3),DS1DSSN                                JM#1 00910
         MVC   DS1DSSN(3),DS1SYSCD+13                              JM#1 00911
LSTUSDT2 LA    R2,DS1DSSN                                          JM#1 00912
         LA    R3,L1SERIAL-3                                       JM#1 00913
         BAL   R14,DATEDIT                                         JM#1 00914
         LA    R2,DS1DSSN+3                                        JM#1 00915
         BAL   R14,CONVERT3                                        JM#1 00916
         MVC   L1SERIAL+6(5),CONVEDIT+7                            JM#1 00917
         B     FM1CREDT                                            JM#1 00918
         SPACE 1                                                        00919
FM1SECUR MVC   L1SECUR,=C'-/-'                                          00920
         TM    DS1DSIND,X'10'  TEST FOR PASSWORD FOR R & W              00921
         BZ    FM1CREDT     IF NO BITS....NO PASSWORD                   00922
         MVI   L1SECUR+2,C'W'      AT LEAST "WRITE" IF ANY              00923
         TM    DS1DSIND,X'04'      TEST FOR ONLY "WRITE"..READ OK       00924
         BO    FM1CREDT       IF ON,  "READ" NOT PROTECTED              00925
         MVI   L1SECUR,C'R'      INDICATE "READ" PROTECT                00926
         SPACE 1                                                        00927
FM1CREDT LA    R2,DS1CREDT                                              00928
         LA    R3,L1CREDT                                               00929
         BAL   R14,DATEDIT                                              00930
         SPACE 1                                                        00931
         LA    R2,DS1EXPDT                                              00932
         LA    R3,L1EXPDT                                               00933
         BAL   R14,DATEDIT                                              00934
         SPACE 1                                                        00935
FM1DSORG LA    R2,L1DSORG                                               00936
         TM    DS1DSORG,DCBDSGIS                                        00937
         BZ    FM1DSO1                                                  00938
         MVC   0(2,R2),=C'IS'                                           00939
         LA    R2,2(R2)                                                 00940
FM1DSO1  TM    DS1DSORG,DCBDSGPS                                        00941
         BZ    FM1DSO2                                                  00942
         MVC   0(2,R2),=C'PS'                                           00943
         LA    R2,2(R2)                                                 00944
FM1DSO2  TM    DS1DSORG,DCBDSGDA                                        00945
         BZ    FM1DSO3                                                  00946
         MVC   0(2,R2),=C'DA'                                           00947
         LA    R2,2(R2)                                                 00948
FM1DSO3  TM    DS1DSORG,DCBDSGCX                                        00949
         BZ    FM1DSO6              AXC                                 00950
         MVC   0(2,R2),=C'CX'                                           00951
         LA    R2,2(R2)                                                 00952
*FM1DSO4 TM    DS1DSORG,=X'08'      AXC                                 00953
*        BZ    FM1DSO5              AXC                                 00954
*        MVC   0(2,R2),=C'CQ'       AXC                                 00955
*        LA    R2,2(R2)             AXC                                 00956
*FM1DSO5 TM    DS1DSORG,=X'04'      AXC                                 00957
*        BZ    FM1DSO6              AXC                                 00958
*        MVC   0(2,R2),=C'MQ'       AXC                                 00959
*        LA    R2,2(R2)             AXC                                 00960
FM1DSO6  TM    DS1DSORG,DCBDSGPO                                        00961
         BZ    FM1DSO7                                                  00962
         MVC   0(2,R2),=C'PO'                                           00963
         LA    R2,2(R2)                                                 00964
FM1DSO7  TM    DS1DSORG+1,DCBDSGGS                                      00965
         BZ    FM1DSO8                                                  00966
         MVC   0(2,R2),=C'GS'                                           00967
         LA    R2,2(R2)                                                 00968
FM1DSO8  TM    DS1DSORG+1,DCBDSGTX                                      00969
         BZ    FM1DSO9                                                  00970
         MVC   0(2,R2),=C'TX'                                           00971
         LA    R2,2(R2)                                                 00972
FM1DSO9  TM    DS1DSORG+1,DCBDSGTQ                                      00973
         BZ    FM1DSO10                                                 00974
         MVC   0(2,R2),=C'TQ'                                           00975
         LA    R2,2(R2)                                                 00976
FM1DSO10 TM    DS1DSORG+1,DCBACBM                                       00977
         BZ    FM1DSO11                                                 00978
         MVC   0(2,R2),=C'AM'                                           00979
         LA    R2,2(R2)                                                 00980
FM1DSO11 TM    DS1DSORG+1,DCBDSGTR                                      00981
         BZ    FM1DSO12                                                 00982
         MVC   0(2,R2),=C'TR'                                           00983
         LA    R2,2(R2)                                                 00984
FM1DSO12 TM    DS1DSORG,DCBDSGU                                         00985
         BZ    *+8                                                      00986
         MVI   0(R2),C'U'                                               00987
         SPACE 1                                                        00988
         LA    R2,L1RECFM                                               00989
         TM    DS1RECFM,DCBRECU                                         00990
         BZ    FM1RECF1                                                 00991
         MVI   0(R2),C'U'                                               00992
         BO    FM1RECF1                                                 00993
         TM    DS1RECFM,DCBRECF                                         00994
         MVI   0(R2),C'F'                                               00995
         BO    FM1RECF1                                                 00996
         MVI   0(R2),C'V'                                               00997
FM1RECF1 LA    R2,1(R2)                                                 00998
         TM    DS1RECFM,DCBRECTO                                        00999
         BZ    FM1RECF2                                                 01000
         MVI   0(R2),C'T'                                               01001
         LA    R2,1(R2)                                                 01002
FM1RECF2 TM    DS1RECFM,DCBRECBR                                        01003
         BZ    FM1RECF3                                                 01004
         MVI   0(R2),C'B'                                               01005
         LA    R2,1(R2)                                                 01006
FM1RECF3 TM    DS1RECFM,DCBRECSB                                        01007
         BZ    FM1RECF4                                                 01008
         MVI   0(R2),C'S'                                               01009
         LA    R2,1(R2)                                                 01010
FM1RECF4 TM    DS1RECFM,DCBRECCC                                        01011
         BNM   FM1BLKSZ                                                 01012
         TM    DS1RECFM,DCBRECCA                                        01013
         MVI   0(R2),C'A'                                               01014
         BO    FM1BLKSZ                                                 01015
         MVI   0(R2),C'M'                                               01016
         SPACE 1                                                        01017
FM1BLKSZ LA    R2,DS1BLKL                                               01018
         BAL   R14,CONVERT2                                             01019
         MVC   L1BLKSIZ,CONVEDIT+7                                      01020
         SPACE 1                                                        01021
         LA    R2,DS1LRECL                                              01022
         BAL   R14,CONVERT2                                             01023
         MVC   L1LRECL,CONVEDIT+7                                       01024
         SPACE 1                                                        01025
         LA    R2,DS1KEYL                                               01026
         BAL   R14,CONVERT1                                             01027
         MVC   L1KEYLEN,CONVEDIT+9                                      01028
         SPACE 1                                                        01029
         UNPK  TRAREA,DS1OPTCD(8)                                       01030
         TR    TRAREA,TRTABLE                                           01031
         MVC   L1OPTCD,TRAREA                                           01032
         SPACE 1                                                        01033
         L     R0,F1TRKAL                                               01034
         BAL   R14,CONVERT                                              01035
         MVC   L1TRKAL,CONVEDIT+7                                       01036
         SPACE 1                                                        01037
         CLC   DS1LSTAR(5),ZEROES                                       01038
         BE    FM1NOEPV                                                 01039
         LH    R0,DS1LSTAR                                              01040
         CLI   DS1LSTAR+2,0                                             01041
         BE    *+8                                                      01042
         AH    R0,=H'1'                                                 01043
         BAL   R14,CONVERT                                              01044
         MVC   L1TRKUS,CONVEDIT+7                                       01045
         SPACE 1                                                        01046
FM1NOEPV LA    R2,DS1NOEPV                                              01047
         BAL   R14,CONVERT1                                             01048
         MVC   L1NOEPV,CONVEDIT+10                                      01049
         SPACE 1                                                        01050
         LA    R2,DS1SCALO+1                                            01051
         BAL   R14,CONVERT3                                             01052
         MVC   L1SECQU,CONVEDIT+7                                       01053
         C     R0,=F'99999'                                             01054
         BNH   FM1SCALO                                                 01055
         MVC   L1SECQU,STARS                                            01056
         SPACE 1                                                        01057
FM1SCALO TM    DS1SCALO,X'C0'                                           01058
         BNO   FM1SCAL1                                                 01059
         MVI   L1TYP,C'C'                                               01060
         B     FM1SCAL4                                                 01061
FM1SCAL1 BNZ   FM1SCAL2                                                 01062
         MVI   L1TYP,C'A'                                               01063
         B     FM1SCAL4                                                 01064
FM1SCAL2 TM    DS1SCALO,X'80'                                           01065
         BO    FM1SCAL3                                                 01066
         MVI   L1TYP,C'B'                                               01067
         B     FM1SCAL4                                                 01068
FM1SCAL3 MVI   L1TYP,C'T'                                               01069
FM1SCAL4 LA    R2,L1TYP+1                                               01070
         TM    DS1SCALO,X'08'                                           01071
         BZ    FM1SCAL5                                                 01072
         MVI   0(R2),C'C'                                               01073
         LA    R2,1(,R2)                                                01074
FM1SCAL5 TM    DS1SCALO,X'04'                                           01075
         BZ    FM1SCAL6                                                 01076
         MVI   0(R2),C'M'                                               01077
         LA    R2,1(,R2)                                                01078
FM1SCAL6 TM    DS1SCALO,X'02'                                           01079
         BZ    FM1SCAL7                                                 01080
         MVI   0(R2),C'A'                                               01081
         LA    R2,1(,R2)                                                01082
FM1SCAL7 TM    DS1SCALO,X'01'                                           01083
         BZ    FM1OPTS                                                  01084
         MVI   0(R2),C'R'                                               01085
         SPACE 1                                                        01086
FM1OPTS  MVI   BUF,SPACE1AP                                             01087
         TM    PARMOPT1,EMPTYOPT     TEST FOR "EMPTY" OPTION            01088
         BO    FM1EM1         IF REQUEST GO TO PROCESS IT               01089
         TM    PARMOPT2,MODELOPT   TEST FOR "MODEL" OPTION              01090
         BZ    FM1SKTS0   IF NOT MODEL BYPASS..                         01091
*                                                                       01092
FM1EM1   CLC   DS1LSTAR(5),ZEROES   TEST FOR TTR ZEROED...NOT VALID     01093
         BE    FM1DONXT              IF ALL ZERO...BYPASS               01094
         CLI   DS1LSTAR+2,0         TEST FOR A TTR OF RECORD ZERO       01095
         BNE   FM1DONXT             IF NOT ZERO, NON-EMPTY DSN          01096
         CLC   NUMEXT,ZEROES        TEST FOR ANY VALID EXTENTS          01097
         BNE   FM1EM2              IF NOT ZERO...EMPTY DATASET.         01098
         TM    PARMOPT2,MODELOPT    CHECK FOR "MODEL" OPTION SELECTED   01099
         BO    FM1SKTS0      IF SELECTED...PRINT THIS ENTRY             01100
         B     FM1DONXT    IF NOT MODEL...DON'T INCLUDE IT AS "EMPTY"   01101
FM1EM2   TM    PARMOPT1,EMPTYOPT     CHECK FOR OPTION OF "EMPTY"        01102
         BZ    FM1DONXT  IF NOT SELECTED...DON'T PRINT                  01103
*                                                                       01104
FM1SKTS0 EQU  *                                                         01105
         TM    PARMOPT1,DUMPOPT                                         01106
         BO    FM1XTRAL                                                 01107
         TM    PARMOPT1,EXTNTOPT                                        01108
         BZ    FM1SKTS1                                                 01109
         CLC   NUMEXT,ZEROES                                            01110
         BNE   FM1XTRAL                                                 01111
FM1SKTS1 TM    PARMOPT2,ISAMOPT                                         01112
         BZ    FM1SKTS2                                                 01113
         LTR   R7,R7                                                    01114
         BNZ   FM1XTRAL                                                 01115
FM1SKTS2 TM    PARMOPT1,PDSOPT                                          01116
         BZ    FM1GOPRT                                                 01117
         TM    DS1DSORG,DCBDSGPO                                        01118
         BZ    FM1GOPRT                                                 01119
FM1XTRAL MVI   BUF,SPACE2AP                                             01120
FM1GOPRT BAL   R14,PRINT                                                01121
         SPACE 1                                                        01122
FM1SKTS3 EQU   *                                                        01123
         TM    PARMOPT1,DUMPOPT                                         01124
         BZ    FM1EXDMP                                                 01125
         LA    R2,DS1                                                   01126
         LA    R3,DS1FDAD                                               01127
         BAL   R14,DUMPDSCB                                             01128
         LTR   R7,R7                                                    01129
         BZ    FM1DMP3                                                  01130
         LA    R2,DS2                                                   01131
         LA    R3,DS2FDAD                                               01132
         BAL   R14,DUMPDSCB                                             01133
FM1DMP3  LTR   R8,R8                                                    01134
         BZ    FM1EXDMP                                                 01135
         LA    R2,DS3                                                   01136
         LA    R3,DS3FDAD                                               01137
         BAL   R14,DUMPDSCB                                             01138
         SPACE 1                                                        01139
FM1EXDMP TM    PARMOPT1,EXTNTOPT                                        01140
         BZ    FM1PDSDP                                                 01141
         CLC   NUMEXT,ZEROES                                            01142
         BE    FM1PDSDP                                                 01143
         MVC   BUF+10(L'HEAD2DAT),HEAD2DAT                              01144
         MVI   BUF,SPACE0AP                                             01145
         BAL   R14,PRINT                                                01146
         MVC   BUF+10(L'HEAD2UND),HEAD2UND                              01147
         MVI   BUF,SPACE1AP                                             01148
         BAL   R14,PRINT                                                01149
         L     R2,LISTEXT                                               01150
         LA    R3,BUF+9                                                 01151
         SR    R4,R4                                                    01152
         MVI   EXPFLAG,X'FF'                                            01153
         SPACE 1                                                        01154
FM1EXLP  BAL   R14,EXFORMAT                                             01155
         LA    R4,4(,R4)                                                01156
         L     R2,LISTEXT(R4)                                           01157
         LTR   R2,R2                                                    01158
         BZ    FM1EXLST                                                 01159
         BAL   R14,PRINT                                                01160
         B     FM1EXLP                                                  01161
FM1EXLST MVI   BUF,SPACE2AP                                             01162
         BAL   R14,PRINT                                                01163
         SPACE 1                                                        01164
FM1PDSDP TM    PARMOPT1,PDSOPT                                          01165
         BZ    FM1ISDMP                                                 01166
         TM    DS1DSORG,DCBDSGPO                                        01167
         BZ    FM1ISDMP                                                 01168
         LA    R2,DS1                                                   01169
         MVC   DSNAME2+1(44),DS1DSNAM                              JM#1 01170
         MVC   HEAD1B,H1BNEW                                       JM#1 01171
         BAL   R14,PDSLIST                                              01172
         MVC   HEAD1B,H1BOLD                                       JM#1 01173
         SPACE 1                                                        01174
FM1ISDMP TM    PARMOPT2,ISAMOPT                                         01175
         BZ    FM1DONXT                                                 01176
         BAL   R14,ISAMLIST                                             01177
FM1DONXT B     FM1PRLOP                                                 01178
*                                                                       01179
* G.D.F. ROUTINE TO CONVERT INPUT & OUTPUT DATES TO                     01180
* SAME FORMAT AS CREDAT & EXPDAT FOR DATEDIT ROUTINE                    01181
*                                                                       01182
BINARY   UNPK  DASAVE(3),0(2,R2)  G.D.F.                                01183
         PACK  DATEWORD,DASAVE(2)  G.D.F.                               01184
         CVB   R1,DATEWORD    G.D.F.                                    01185
         STC   R1,0(R2)       G.D.F.                                    01186
         ZAP   DATEWORD,1(2,R2)  G.D.F.                                 01187
         CVB   R1,DATEWORD    G.D.F.                                    01188
         STH   R1,DATEWORD    G.D.F.                                    01189
         MVC   1(2,R2),DATEWORD  G.D.F.                                 01190
         BR    R14            G.D.F.                                    01191
*                                                                       01192
* END OF BINARY CONVERT ROUTINE                                         01193
*                                                                       01194
         SPACE 2                                                        01195
FM1PREND MVI   BUF,SPACE1IM                                             01196
         BAL   R14,PRINT                                                01197
         MVI   BUF+1,C' '          MOVE TO BLANK OUT LINE               01198
         MVC   BUF+2(131),BUF+1    BLANK OUT PRINT LINE                 01199
         MVC   BUF+49(14),=C'<<<<< END VTOC'                            01200
         LH    R0,FM1COUNT                                              01201
         BAL   R14,CONVERT                                              01202
         MVC   BUF+64(4),CONVEDIT+8                                     01203
         MVC   BUF+69(15),=C'DATA SETS >>>>>'                           01204
         MVI   BUF,SPACE3AP                                             01205
         BAL   R14,PRINT                                                01206
         SPACE 1                                                        01207
         TM    PARMOPT1,MAPOPT+DIRFLAG                                  01208
         BZ    MAPEND                                                   01209
         SPACE 1                                                        01210
         DROP  R6,R7,R8                                                 01211
         EJECT                                                          01212
MAPPRINT MVC   CURLINES,=H'999'                                         01213
         LA    R0,HEAD2A                                                01214
         ST    R0,BUFPTR                                                01215
         MVI   HEADMID,C' '                                             01216
         MVC   HEADMID+1(81),HEADMID                                    01217
         MVC   HEAD2VOL,VOLSERNO                                        01218
         MVC   HEADMID(40),HEAD2                                        01219
         L     R6,HOOKSTRT                                              01220
         USING EXTENT,R6                                                01221
         L     R4,=F'-1'                                                01222
         SR    R5,R5                                                    01223
         MVI   EXPFLAG,0                                                01224
         SPACE 1                                                        01225
MAPPRLOP CLC   EXTLCCHH,HOOKEND                                         01226
         BE    MAPPREND                                                 01227
         CLC   EXTHITT,TRKSPVOL                                         01228
         BNL   MAPINVAL                                                 01229
         CLC   EXTLOTT,EXTHITT                                          01230
         BH    MAPINVAL                                                 01231
         CLI   EXTTYPE,X'80'                                            01232
         BE    MAPGETEX                                                 01233
         LH    R0,EXTLOTT                                               01234
         SR    R0,R4                                                    01235
         S     R0,=F'1'                                                 01236
         BZ    MAPTRGET                                                 01237
         BP    MAPTRMIS                                                 01238
         BAL   R14,CONVERT                                              01239
         MVC   BUF+1(5),CONVEDIT+7                                      01240
         MVC   BUF+7(14),=C'TRACKS OVERLAP'                             01241
         CH    R4,EXTHITT                                               01242
         BNL   *+8                                                      01243
MAPTRGET LH    R4,EXTHITT                                               01244
         AH    R5,EXTNOTRK                                              01245
         B     MAPGETEX                                                 01246
         SPACE 1                                                        01247
MAPINVAL MVC   BUF+7(14),=C'INVALID EXTENT'                             01248
         B     MAPGETEX                                                 01249
         SPACE 1                                                        01250
MAPTRMIS BAL   R14,CONVERT                                              01251
         MVC   BUF+1(5),CONVEDIT+7                                      01252
         MVC   BUF+7(14),=C'TRACKS MISSING'                             01253
         MVI   BUF,SPACE1AP                                             01254
         BAL   R14,PRINT                                                01255
         B     MAPTRGET                                                 01256
         SPACE 1                                                        01257
MAPGETEX LA    R2,EXTENT                                                01258
         LA    R3,BUF+22                                                01259
         BAL   R14,EXFORMAT                                             01260
         BAL   R14,PRINT                                                01261
         L     R6,EXTPTR                                                01262
         B     MAPPRLOP                                                 01263
         SPACE 3                                                        01264
MAPPREND LH    R0,TRKSPVOL                                              01265
         SR    R0,R4                                                    01266
         S     R0,=F'1'                                                 01267
         BNP   MAPNOMIS                                                 01268
         BAL   R14,CONVERT                                              01269
         MVC   BUF+1(5),CONVEDIT+7                                      01270
          MVC  BUF+7(40),=C'TRACKS MISSING OR ASSIGNED AS ALTERNATES'   01271
         MVI   BUF,SPACE1AP                                             01272
         BAL   R14,PRINT                                                01273
MAPNOMIS MVI   BUF,SPACE1IM                                             01274
         BAL   R14,PRINT                                                01275
         LR    R0,R5                                                    01276
         BAL   R14,CONVERT                                              01277
         MVC   BUF+59(5),CONVEDIT+7                                     01278
         MVC   BUF+66(20),=C'TRACKS ACCOUNTED FOR'                      01279
         MVI   BUF,SPACE2AP                                             01280
         BAL   R14,PRINT                                                01281
         MVC   BUF+59(28),=C'<<<<< END OF TRACK MAP >>>>>'              01282
         MVI   BUF,SPACE0AP                                             01283
         BAL   R14,PRINT                                                01284
MAPEND   B     NEXTVOL                                                  01285
         SPACE 1                                                        01286
         DROP  R6                                                       01287
         EJECT                                                          01288
ERRNODD  TM    PARMOPT2,VOLSOPT                                         01289
         BNO   NEXTDD                                                   01290
         MVC   BUF+41(19),=C'CANNOT FIND DD CARD'                       01291
         B     ERRCON1                                                  01292
         SPACE 1                                                        01293
ERRNOTDA TM    PARMOPT2,VOLSOPT                                         01294
         BNO   NEXTDD                                                   01295
         MVC   BUF+41(27),=C'DEVICE IS NOT DIRECT ACCESS'               01296
         B     ERRCON1                                                  01297
         SPACE 1                                                        01298
ERRUNKDV MVC   BUF+41(19),=C'UNKNOWN DEVICE TYPE'                       01299
         B     ERRCON1                                                  01300
         SPACE 1                                                        01301
ERRNOPEN MVC   BUF+41(27),=C'ATTEMPT TO OPEN VTOC FAILED'               01302
         B     ERRCON1                                                  01303
         SPACE 1                                                        01304
ERRCON1  MVC   BUF+10(28),=C'ERROR CONCERNING "VOLUME01":'              01305
         MVC   BUF+28(8),VOLDDNAM                                       01306
         MVI   BUF,SPACE3AP                                             01307
         BAL   R14,PRINT                                                01308
         LA    R0,4                                                     01309
         B     ERRCODST                                                 01310
         SPACE 1                                                        01311
ERRNOTFX MVC   BUF+41(33),=C'BAD DSCB - SHOULD HAVE BEEN TYPE'          01312
         MVC   BUF+75(1),BADDSTYP                                       01313
         LR    R2,R8                                                    01314
         B     ERRCON2                                                  01315
         SPACE 1                                                        01316
ERRNOCOR MVC   BUF+41(41),=C'INSUFFICIENT MEMORY TO COMPLETE VTOC LIST' 01317
         SR    R2,R2                                                    01318
         B     ERRCON2                                                  01319
         SPACE 1                                                        01320
ERRCON2  BAL   R14,CLOSVTOC                                             01321
         BAL   R14,DEQVTOC                                              01322
         MVC   BUF+10(28),=C'ERROR CONCERNING "VOLUME01":'              01323
         MVC   BUF+28(8),VOLDDNAM                                       01324
         MVI   BUF,SPACE3AP                                             01325
         BAL   R14,PRINT                                                01326
         LTR   R2,R2                                                    01327
         BZ    ERRNODMP                                                 01328
         LA    R3,DS4FDAD-DS4(R2)                                       01329
         BAL   R14,DUMPDSCB                                             01330
ERRNODMP LA    R0,8                                                     01331
ERRCODST C     R0,RETCODE                                               01332
         BL    *+8                                                      01333
         ST    R0,RETCODE                                               01334
         B     NEXTVOL                                                  01335
         EJECT                                                          01336
*                                                                       01337
*        SUBROUTINES START HERE                                         01338
*                                                                       01339
PDSLIST  ST    R14,PDSAVE                                               01340
         STM   R2,R6,PDSAVE+4                                           01341
         USING DS1,R2                                                   01342
         MVC   JFCBDSNM,DS1DSNAM                                        01343
         SR    R0,R0                                                    01344
         IC    R0,DS1NOBDB                                              01345
         BAL   R14,CONVERT                                              01346
         DROP  R2                                                       01347
         MVC   PDSVAL4,CONVEDIT+9                                       01348
         SPACE 1                                                        01349
         OPEN  (PDSDCB),TYPE=J                                          01350
         L     R3,PDSBLKAD+4                                            01351
         READ  PDSDECB,SF,,(3),MF=E                                     01352
         SPACE 1                                                        01353
         SR    R0,R0                                                    01354
         STH   R0,PDSBYTCT                                              01355
         STH   R0,PDSBLKAL                                              01356
         STH   R0,PDSBLKUS                                              01357
         STH   R0,PDSMEMCT                                              01358
PDSNEXT  LH    R0,PDSBYTCT                                              01359
         LTR   R0,R0                                                    01360
         BP    PDSPRINT                                                 01361
         CHECK PDSDECB                                                  01362
         SPACE 1                                                        01363
         CLI   SYNADFLG,0                                               01364
         BE    PDSREDOK                                                 01365
         MVC   BUF+28(11),=CL11'DIRECTORY.'                             01366
         MVI   BUF,SPACE3AP                                             01367
         BAL   R14,PRINT                                                01368
         CLI   SYNADFLG,X'FF'                                           01369
         BE    PDSEOD                                                   01370
         BAL   R14,ABDUMP                                               01371
         SPACE 1                                                        01372
PDSREDOK LM    R2,R3,PDSBLKAD                                           01373
         XR    R2,R3                                                    01374
         XR    R3,R2                                                    01375
         XR    R2,R3                                                    01376
         STM   R2,R3,PDSBLKAD                                           01377
         READ  PDSDECB,SF,,(3),MF=E                                     01378
         SPACE 1                                                        01379
         USING PDS,R2                                                   01380
         LH    R1,PDSBLKAL                                              01381
         LA    R1,1(R1)                                                 01382
         STH   R1,PDSBLKAL                                              01383
         LH    R0,PDSCOUNT                                              01384
         SH    R0,=H'2'                                                 01385
         STH   R0,PDSBYTCT                                              01386
         LA    R1,PDSENTRY                                              01387
         ST    R1,PDSENTAD                                              01388
         B     PDSNEXT                                                  01389
         SPACE 1                                                        01390
         DROP  R2                                                       01391
         SPACE 3                                                        01392
PDSPRINT L     R6,PDSENTAD                                              01393
         USING PDSENTRY,R6                                              01394
         IC    R2,PDSINDIC                                              01395
         N     R2,=A(PDSUSERH)                                          01396
         SLL   R2,1                                                     01397
         LR    R1,R6                                                    01398
         AR    R1,R2                                                    01399
         LA    R1,12(R1)                                                01400
         ST    R1,PDSENTAD                                              01401
         LH    R1,PDSBYTCT                                              01402
         SR    R1,R2                                                    01403
         SH    R1,=Y(PDSUSERD-PDSENTRY)                                 01404
         STH   R1,PDSBYTCT                                              01405
         CLC   PDSNAME,EFFS                                             01406
         BNE   PDSMEMOK                                                 01407
         MVC   PDSBLKUS,PDSBLKAL                                        01408
         B     PDSNEXT                                                  01409
PDSMEMOK LH    R1,PDSMEMCT                                              01410
         LA    R1,1(R1)                                                 01411
         STH   R1,PDSMEMCT                                              01412
         MVC   BUF+12(8),PDSNAME                                        01413
         TM    PDSINDIC,PDSALIAS                                        01414
         BZ    *+8                                                      01415
         MVI   BUF+21,C'A'                                              01416
         UNPK  TRAREA,PDSTTRP(8)                                        01417
         TR    TRAREA,TRTABLE                                           01418
         MVC   BUF+23(4),TRAREA                                         01419
         MVI   BUF+27,C'.'                                              01420
         MVC   BUF+28(2),TRAREA+4                                       01421
         IC    R0,PDSINDIC                                              01422
         N     R0,=A(PDS#TTRS)                                          01423
         SRL   R0,5                                                     01424
         STC   R0,BUF+32                                                01425
         OI    BUF+32,X'F0'                                             01426
         LR    R5,R2                                                    01427
         CH    R2,=H'44'                                                01428
         BNH   PDSPRLIN                                                 01429
         LA    R2,2                                                     01430
         BAL   R14,PRLKAHED                                             01431
         LR    R2,R5                                                    01432
         LA    R5,44                                                    01433
PDSPRLIN LA    R3,PDSUSERD                                              01434
         LA    R4,BUF+35                                                01435
         BAL   R14,DUMPLINE                                             01436
         MVI   BUF,SPACE1AP                                             01437
         BAL   R14,PRINT                                                01438
         CH    R2,=H'44'                                                01439
         BNH   PDSNEXT                                                  01440
         LR    R5,R2                                                    01441
         SH    R5,=H'44'                                                01442
         LA    R3,PDSUSERD+44                                           01443
         LA    R4,BUF+35                                                01444
         BAL   R14,DUMPLINE                                             01445
         MVI   BUF,SPACE1AP                                             01446
         BAL   R14,PRINT                                                01447
         B     PDSNEXT                                                  01448
         SPACE 1                                                        01449
         DROP  R6                                                       01450
         SPACE 2                                                        01451
PDSEOD   CLOSE (PDSDCB)                                                 01452
         CLI   SYNADFLG,0                                               01453
         MVI   SYNADFLG,0                                               01454
         BNE   PDSRETRN                                                 01455
         LH    R0,PDSMEMCT                                              01456
         BAL   R14,CONVERT                                              01457
         MVC   PDSVAL1,CONVEDIT+8                                       01458
         LH    R0,PDSBLKUS                                              01459
         BAL   R14,CONVERT                                              01460
         MVC   PDSVAL2,CONVEDIT+8                                       01461
         LH    R0,PDSBLKAL                                              01462
         BAL   R14,CONVERT                                              01463
         MVC   PDSVAL3,CONVEDIT+8                                       01464
         MVC   BUF+10(PDSMSGLN),PDSMSG                                  01465
         MVI   BUF,SPACE3AP                                             01466
         BAL   R14,PRINT                                                01467
PDSRETRN LM    R2,R6,PDSAVE+4                                           01468
         L     R14,PDSAVE                                               01469
         BR    R14                                                      01470
         EJECT ,                                                        01471
         SPACE 1                                                        01472
         USING DS2,R7                                                   01473
ISAMLIST LTR   R7,R7                                                    01474
         BZR   R14                                                      01475
         ST    R14,ISAVE                                                01476
         STM   R2,R5,ISAVE+4                                            01477
         SPACE 1                                                        01478
         MVC   BUF+12(19),=C'NO OF INDEX LEVELS='                       01479
         LA    R2,DS2NOLEV                                              01480
         BAL   R14,CONVERT1                                             01481
         MVC   BUF+31(3),CONVERTD                                       01482
         SPACE 1                                                        01483
         MVC   BUF+42(19),=C'FLAGGED FOR DELETE='                       01484
         LA    R2,DS2TAGDT                                              01485
         BAL   R14,CONVERT2                                             01486
         MVC   BUF+61(5),CONVERTD                                       01487
         SPACE 1                                                        01488
         MVC   BUF+72(19),=C'TRKS FOR HIGH INDX='                       01489
         LA    R2,DS2NOTRK                                              01490
         BAL   R14,CONVERT1                                             01491
         MVC   BUF+91(3),CONVERTD                                       01492
         SPACE 1                                                        01493
         MVC   BUF+102(19),=C'IND OVFL TRKS LEFT='                      01494
         LA    R2,DS2RORG2                                              01495
         BAL   R14,CONVERT2                                             01496
         MVC   BUF+121(5),CONVERTD                                      01497
         MVI   BUF,SPACE1AP                                             01498
         BAL   R14,PRINT                                                01499
         SPACE 1                                                        01500
         MVC   BUF+12(19),=C'TRKS FOR MAST INDX='                       01501
         LA    R2,DS2DVIND                                              01502
         BAL   R14,CONVERT1                                             01503
         MVC   BUF+31(3),CONVERTD                                       01504
         SPACE 1                                                        01505
         MVC   BUF+42(19),=C'OVERFLOW  ACCESSES='                       01506
         LA    R2,DS2RORG3                                              01507
         BAL   R14,CONVERT3                                             01508
         MVC   BUF+61(8),CONVERTD                                       01509
         SPACE 1                                                        01510
         MVC   BUF+72(19),=C'PRIME DATA RECORDS='                       01511
         LA    R2,DS2PRCTR                                              01512
         BAL   R14,CONVERT4                                             01513
         MVC   BUF+91(10),CONVERTD                                      01514
         SPACE 1                                                        01515
         MVC   BUF+102(19),=C'NO OF OVFL RECORDS='                      01516
         LA    R2,DS2OVRCT                                              01517
         BAL   R14,CONVERT2                                             01518
         MVC   BUF+121(5),CONVERTD                                      01519
         MVI   BUF,SPACE1AP                                             01520
         BAL   R14,PRINT                                                01521
         SPACE 1                                                        01522
         MVC   BUF+12(19),=C'CYL OVFL  TRKS/CYL='                       01523
         LA    R2,DS2CYLOV                                              01524
         BAL   R14,CONVERT1                                             01525
         MVC   BUF+31(3),CONVERTD                                       01526
         SPACE 1                                                        01527
         MVC   BUF+42(19),=C'CORE FOR HIGH INDX='                       01528
         LA    R2,DS2NOBYT                                              01529
         BAL   R14,CONVERT2                                             01530
         MVC   BUF+61(5),CONVERTD                                       01531
         SPACE 1                                                        01532
         MVC   BUF+72(19),=C'IND OFL BYTES LEFT='                       01533
         LA    R2,DS2BYOVL                                              01534
         BAL   R14,CONVERT2                                             01535
         MVC   BUF+91(5),CONVERTD                                       01536
         SPACE 1                                                        01537
         MVC   BUF+102(19),=C'FULL CYLOVFL AREAS='                      01538
         LA    R2,DS2RORG1                                              01539
         BAL   R14,CONVERT2                                             01540
         MVC   BUF+121(5),CONVERTD                                      01541
         MVI   BUF,SPACE2AP                                             01542
         BAL   R14,PRINT                                                01543
         SPACE 1                                                        01544
         LM    R2,R5,ISAVE+4                                            01545
         L     R14,ISAVE                                                01546
         BR    R14                                                      01547
         DROP  R7                                                       01548
         EJECT                                                          01549
         SPACE 1                                                        01550
         USING EXTENT,R2                                                01551
         USING EXLINE,R3                                                01552
         SPACE 1                                                        01553
EXFORMAT LTR   R2,R2               ANY EXTENT.Q                         01554
         BZR   R14                 RETURN IMM IF NOT                    01555
         ST    R14,EXSAVE                                               01556
         STM   R2,R3,EXSAVE+4                                           01557
         SPACE 1                                                        01558
         UNPK  TRAREA,EXTLCCHH(8)                                       01559
         TR    TRAREA,TRTABLE                                           01560
         MVC   EXLFCC,TRAREA                                            01561
         MVI   EXLFPRD,C'.'                                             01562
         MVC   EXLFHH,TRAREA+4                                          01563
         SPACE 1                                                        01564
         UNPK  TRAREA,EXTHCCHH(8)                                       01565
         TR    TRAREA,TRTABLE                                           01566
         MVC   EXLLCC,TRAREA                                            01567
         MVI   EXLLPRD,C'.'                                             01568
         MVC   EXLLHH,TRAREA+4                                          01569
         SPACE 1                                                        01570
         LH    R0,EXTLOTT                                               01571
         BAL   R14,CONVERT                                              01572
         MVC   EXLFTT,CONVEDIT+7                                        01573
         SPACE 1                                                        01574
         LH    R0,EXTHITT                                               01575
         BAL   R14,CONVERT                                              01576
         MVC   EXLLTT,CONVEDIT+7                                        01577
         SPACE 1                                                        01578
         LH    R0,EXTNOTRK                                              01579
         BAL   R14,CONVERT                                              01580
         MVC   EXLNOTRK,CONVEDIT+7                                      01581
         SPACE 1                                                        01582
         CLI   EXPFLAG,0                                                01583
         BNE   EXPTYPE                                                  01584
         L     R1,EXTIDPTR                                              01585
         MVC   EXLDSNAM,0(R1)                                           01586
         SPACE 1                                                        01587
EXPTYPE  CLI   EXTTYPE,X'01'       IS THIS A DATA EXTENT.Q              01588
         BNE   EXPNDATA            NO, GO CHECK OTHERS                  01589
         CLI   EXPFLAG,0           ARE WE MAPPING.Q                     01590
         BE    EXPEXTPR            YES, DON'T CLUTTER UP                01591
         MVC   EXLTYPE,=C'PRIM'    ELSE MOVE IN EXTENT TYPE             01592
         B     EXPEXTPR                                                 01593
         SPACE 1                                                        01594
EXPNDATA TM    EXTTYPE,X'F0'       VOL LABEL, OR TYPE 4, 5, OR 6        01595
         BO    EXPCKFMX            BR IF YES                            01596
         CLI   EXTTYPE,X'02'       ISAM OVERFLOW.Q                      01597
         MVC   EXLTYPE,=C'OVFL'                                         01598
         BE    EXPEXTPR                                                 01599
         SPACE 1                                                        01600
         CLI   EXTTYPE,X'04'       ISAM INDEX.Q                         01601
         MVC   EXLTYPE,=C'INDX'                                         01602
         BE    EXPEXTPR                                                 01603
         SPACE 1                                                        01604
         CLI   EXTTYPE,X'40'       USER LABEL TRACK.Q                   01605
         MVC   EXLTYPE,=C'ULBL'                                         01606
         BE    EXPEXTPR                                                 01607
         SPACE 1                                                        01608
         CLI   EXTTYPE,X'81'       CYLS OF DATA ON CYL BDRY.Q           01609
         MVC   EXLTYPE,=C'CYLB'                                         01610
         BE    EXPEXTPR                                                 01611
         SPACE 1                                                        01612
         CLI   EXTTYPE,X'80'       SHARING AN EXTENT.Q                  01613
         MVC   EXLTYPE,=C'SHRD'                                         01614
         BNE   EXPCKFMX                                                 01615
         CLI   EXPFLAG,0           ARE WE MAPPING.Q                     01616
         BNE   EXPEXTPR            NO, DON'T ENCLOSE IN PARENS          01617
         MVI   EXLLPARN,C'('                                            01618
         MVI   EXLRPARN,C')'                                            01619
         B     EXPEXTPR                                                 01620
         SPACE 1                                                        01621
EXPCKFMX CLI   EXTTYPE,C'5'        FREE EXTENT.Q                        01622
         BE    EXPPRLIN                                                 01623
         SPACE 1                                                        01624
         CLI   EXTTYPE,C'4'        VTOC EXTENT.Q                        01625
         MVC   EXLTYPE,=C'VTOC'                                         01626
         BE    EXPEXTPR                                                 01627
         SPACE 1                                                        01628
         CLI   EXTTYPE,X'FF'       VOLUME LABEL.Q                       01629
         MVC   EXLTYPE,=C'VLBL'                                         01630
         BE    EXPPRLIN                                                 01631
         SPACE 1                                                        01632
         CLI   EXTTYPE,C'6'        SHARED EXTENT.Q                      01633
         MVC   EXLTYPE,=C'*UN*'                                         01634
         BNE   EXPEXTPR                                                 01635
         SPACE 1                                                        01636
         MVC   EXLTYPE,=C'SPLT'                                         01637
         SR    R0,R0                                                    01638
         IC    R0,EXTSEQNO                                              01639
         BAL   R14,CONVERT                                              01640
         MVC   EXLSPLIT(3),CONVEDIT+9                                   01641
         B     EXPPRLIN                                                 01642
         SPACE 1                                                        01643
EXPEXTPR SR    R0,R0                                                    01644
         IC    R0,EXTSEQNO                                              01645
         AH    R0,=H'1'                                                 01646
         BAL   R14,CONVERT                                              01647
         MVC   EXLSEQNO,CONVEDIT+10                                     01648
         SPACE 1                                                        01649
EXPPRLIN MVI   BUF,SPACE1AP                                             01650
         LM    R2,R3,EXSAVE+4                                           01651
         L     R14,EXSAVE                                               01652
         BR    R14                                                      01653
         DROP  R2,R3                                                    01654
         EJECT                                                          01655
         SPACE 3                                                        01656
VTOCREAD ST    R14,VTSAVE                                               01657
         STM   R2,R4,VTSAVE+4                                           01658
         L     R2,RENEXT@                                               01659
         CHECK (2)                                                      01660
         LA    R1,=CL11'VTOC READ.'                                     01661
         BAL   R14,SYNADCHK                                             01662
         SPACE 1                                                        01663
         USING DS1,R3                                                   01664
VTOCREOK XC    0(20,R2),0(R2)                                           01665
         LA    R4,20(R2)                                                01666
         MVC   DS1(DS1END-DS1),0(R4)                                    01667
         MVC   DS1FDAD(3),VTOCMBB                                       01668
         MVC   DS1FDAD+3(4),VTOCCCHH                                    01669
         MVC   DS1FDAD+7(1),VTOCR                                       01670
         CLC   HWMDS1,DS1FDAD+3                                         01671
         BL    VTOCEOD                                                  01672
         SPACE 1                                                        01673
         READ  (2),SF,VTOCDCB,(4),MF=E                                  01674
         A     R2,REBLKSIZ                                              01675
         ST    R2,RENEXT@                                               01676
         L     R1,RECOUNT                                               01677
         BCT   R1,VTSAVECT                                              01678
         L     R2,REBLOCK@                                              01679
         ST    R2,RENEXT@                                               01680
         L     R1,RENCP                                                 01681
VTSAVECT ST    R1,RECOUNT                                               01682
         SPACE 1                                                        01683
         LA    R0,1                                                     01684
         SR    R1,R1                                                    01685
         IC    R1,VTOCR                                                 01686
         AR    R1,R0                                                    01687
         STC   R1,VTOCR                                                 01688
         CH    R1,VTDSCBTR                                              01689
         BNH   VTOCREND                                                 01690
         MVI   VTOCR,1                                                  01691
         AH    R0,VTOCTT                                                01692
         STH   R0,VTOCTT                                                01693
         LR    R1,R0                                                    01694
         BAL   R14,TTCONVRT                                             01695
         MVC   VTOCCCHH,CCHH                                            01696
         SPACE 1                                                        01697
VTOCREND L     R14,VTSAVE                                               01698
         LM    R2,R4,VTSAVE+4                                           01699
         LA    R14,4(R14)                                               01700
         BR    R14                                                      01701
         SPACE 1                                                        01702
VTOCEOD  L     R14,VTSAVE                                               01703
         LM    R2,R4,VTSAVE+4                                           01704
         BR    R14                                                      01705
         SPACE 1                                                        01706
         DROP  R3                                                       01707
         EJECT                                                          01708
         SPACE 3                                                        01709
OBTAIN   MVC   OBCCHHR,0(R2)                                            01710
         OBTAIN OBCAMLST                                                01711
         BXLE  R15,R15,*+8                                              01712
         BAL   R14,ABDUMP                                               01713
         USING DS1,R3                                                   01714
         MVC   DS1(DS1END-DS1),CAMLIST                                  01715
         MVC   DS1FDAD(3),VTOCMBB                                       01716
         MVC   DS1FDAD+3(5),0(R2)                                       01717
         BR    R14                                                      01718
         SPACE 2                                                        01719
OBCAMLST CAMLST SEEK,OBCCHHR,VOLSERNO,CAMLIST                           01720
         SPACE 1                                                        01721
         DROP  R3                                                       01722
         EJECT                                                          01723
         SPACE 3                                                        01724
SYNADXIT SYNADAF ACSMETH=BSAM                                           01725
         MVC   BUF+7(47),=C'I/O ERROR PROCESSING XXXXXXXXXX. SYNADAF INX01726
               FO="'                                                    01727
         MVC   BUF+54(78),50(R1)                                        01728
         MVI   BUF+132,C'"'                                             01729
         SYNADRLS                                                       01730
         MVI   SYNADFLG,X'FF'                                           01731
         LTR   R0,R0                                                    01732
         BZR   R14                                                      01733
         MVI   SYNADFLG,1                                               01734
         BR    R14                                                      01735
         SPACE 3                                                        01736
SYNADCHK CLI   SYNADFLG,0                                               01737
         BER   R14                                                      01738
         MVC   BUF+28(11),0(R1)                                         01739
         BAL   R14,CLOSVTOC                                             01740
         BAL   R14,DEQVTOC                                              01741
         MVI   BUF,SPACE3IM                                             01742
         BAL   R14,PRINT                                                01743
         MVI   BUF,SPACE3AP                                             01744
         BAL   R14,PRINT                                                01745
         CLI   SYNADFLG,X'FF'                                           01746
         BE    ERRNODMP                                                 01747
         BAL   R14,ABDUMP                                               01748
         EJECT                                                          01749
         SPACE 3                                                        01750
DEQGATE  EQU   *+1                                                      01751
DEQVTOC  BCR   *-*+15,R14                                               01752
         OI    DEQGATE,X'F0'                                            01753
         SPACE 1                                                        01754
         DEQ   MF=(E,ENQVTOC)                                           01755
         SPACE 1                                                        01756
         BR    R14                                                      01757
         SPACE 4                                                        01758
         SPACE 1                                                        01759
CLOSVTOC CLOSE MF=(E,CLOSLIST)                                          01760
         SPACE 1                                                        01761
         L     R1,REBLOCK@                                              01762
         LTR   R1,R1                                                    01763
         BZR   R14                                                      01764
         L     R0,REGETSIZ                                              01765
         FREEMAIN R,LV=(0),A=(1)                                        01766
         SR    R0,R0                                                    01767
         ST    R0,REBLOCK@                                              01768
         BR    R14                                                      01769
         EJECT                                                          01770
         SPACE 3                                                        01771
         USING DS1,R6                                                   01772
         USING DS3,R8                                                   01773
         SPACE 1                                                        01774
F13HOOK  ST    R14,F1SAVE                                               01775
         SR    R5,R5                                                    01776
         ST    R5,F1TRKAL                                               01777
         STH   R5,NUMEXT                                                01778
         XC    LISTEXT(17*4),LISTEXT                                    01779
         IC    R5,DS1NOEPV                                              01780
         CLI   DS1EXT1,X'40'                                            01781
         BNE   *+8                                                      01782
         AH    R5,=H'1'                                                 01783
         LTR   R5,R5                                                    01784
         BZR   R14                                                      01785
         STH   R5,NUMEXT                                                01786
         SPACE 1                                                        01787
         SR    R3,R3                                                    01788
         SR    R4,R4                                                    01789
F1NXTEXT EX    0,F1EXTPIK(R3)                                           01790
         BAL   R14,F1EXTCNV                                             01791
         AR    R4,R0                                                    01792
         MVC   HOOKLCCH(8),2(R2)                                        01793
         STH   R0,HOOKNTRK                                              01794
         MVC   HOOKTYPE(2),0(R2)                                        01795
         MVC   HOOKLOTT(4),LOWTT                                        01796
         LA    R0,DS1DSNAM                                              01797
         ST    R0,HOOKIDPT                                              01798
         LA    R2,HOOKPTR                                               01799
         BAL   R14,HOOKUP                                               01800
         ST    R15,LISTEXT(R3)                                          01801
         LA    R3,4(R3)                                                 01802
         BCT   R5,F1NXTEXT                                              01803
         ST    R4,F1TRKAL                                               01804
         L     R14,F1SAVE                                               01805
         BR    R14                                                      01806
         EJECT ,                                                        01807
         SPACE 3                                                        01808
F1EXTCNV CLI   0(R2),0                                                  01809
         BER   R14                                                      01810
         LA    R2,2(R2)                                                 01811
         BAL   R15,CCHHCONV                                             01812
         STH   R0,LOWTT                                                 01813
         LA    R2,4(R2)                                                 01814
         BAL   R15,CCHHCONV                                             01815
         STH   R0,HIGHTT                                                01816
         LH    R1,LOWTT                                                 01817
         SR    R0,R1                                                    01818
         AH    R0,=H'1'                                                 01819
         S     R2,=F'6'                                                 01820
         BR    R14                                                      01821
         SPACE 2                                                        01822
F1EXTPIK LA    R2,DS1EXT1                                               01823
         LA    R2,DS1EXT2                                               01824
         LA    R2,DS1EXT3                                               01825
         LA    R2,DS3EXTNT                                              01826
         LA    R2,DS3EXTNT+10                                           01827
         LA    R2,DS3EXTNT+20                                           01828
         LA    R2,DS3EXTNT+30                                           01829
         LA    R2,DS3ADEXT                                              01830
         LA    R2,DS3ADEXT+10                                           01831
         LA    R2,DS3ADEXT+20                                           01832
         LA    R2,DS3ADEXT+30                                           01833
         LA    R2,DS3ADEXT+40                                           01834
         LA    R2,DS3ADEXT+50                                           01835
         LA    R2,DS3ADEXT+60                                           01836
         LA    R2,DS3ADEXT+70                                           01837
         LA    R2,DS3ADEXT+80                                           01838
         SPACE 2                                                        01839
         DROP  R6,R8                                                    01840
         EJECT                                                          01841
         SPACE 3                                                        01842
         USING DS5,R8                                                   01843
*        USING DS6,R8                                                   01844
F56HOOK  ST    R14,F5SAVE                                               01845
         LA    R2,DS5AVEXT                                              01846
         LA    R3,8                                                     01847
         BAL   R14,F5EXTCNV                                             01848
         LA    R2,5(R2)                                                 01849
         BCT   R3,*-8                                                   01850
         LA    R2,DS5MAVET                                              01851
         LA    R3,18                                                    01852
         BAL   R14,F5EXTCNV                                             01853
         LA    R2,5(R2)                                                 01854
         BCT   R3,*-8                                                   01855
         L     R14,F5SAVE                                               01856
         BR    R14                                                      01857
         SPACE 1                                                        01858
F5EXTCNV ST    R14,F5SAVE+4                                             01859
         STM   R2,R5,F5SAVE+8                                           01860
         CLC   0(5,R2),ZEROES                                           01861
         BER   R14                                                      01862
         MVC   FMT5TT(4),0(R2)                                          01863
         LH    R3,FMT5TT                                                01864
         STH   R3,LOWTT                                                 01865
         LH    R4,FMT5CYLS                                              01866
         SR    R5,R5                                                    01867
         IC    R5,4(R2)                                                 01868
         CLI   DS5FMTID,C'6'                                            01869
         BE    F6HOOK                                                   01870
         LH    R1,AVAILEXT                                              01871
         LA    R1,1(R1)                                                 01872
         STH   R1,AVAILEXT                                              01873
         LH    R0,AVAILCYL                                              01874
         AR    R0,R4                                                    01875
         STH   R0,AVAILCYL                                              01876
         LA    R0,=CL44'  **** AVAILABLE ****'                          01877
         ST    R0,HOOKIDPT                                              01878
         MVI   HOOKSEQN,0                                               01879
         LR    R0,R4                                                    01880
         MH    R0,TRKSPCYL                                              01881
         AR    R0,R5                                                    01882
         STH   R0,HOOKNTRK                                              01883
         CH    R0,F5LARGTT                                              01884
         BNH   F5AVAIL                                                  01885
         STH   R0,F5LARGTT                                              01886
         MVC   F5LARGST,2(R2)                                           01887
F5AVAIL  LR    R1,R0                                                    01888
         AH    R1,AVAILSPC                                              01889
         STH   R1,AVAILSPC                                              01890
         EJECT ,                                                        01891
         SPACE 3                                                        01892
F6RETURN AR    R0,R3                                                    01893
         BCTR  R0,0                                                     01894
         STH   R0,HIGHTT                                                01895
         LH    R1,LOWTT                                                 01896
         BAL   R14,TTCONVRT                                             01897
         MVC   HOOKLCCH,CCHH                                            01898
         LH    R1,HIGHTT                                                01899
         BAL   R14,TTCONVRT                                             01900
         MVC   HOOKHCCH,CCHH                                            01901
         MVC   HOOKLOTT(4),LOWTT                                        01902
         MVC   HOOKTYPE,DS5FMTID                                        01903
         LA    R2,HOOKPTR                                               01904
         BAL   R14,HOOKUP                                               01905
         LM    R2,R5,F5SAVE+8                                           01906
         L     R14,F5SAVE+4                                             01907
         BR    R14                                                      01908
         SPACE 1                                                        01909
F6HOOK   STC   R5,HOOKSEQN                                              01910
         MVC   HOOKIDPT,=A(FMT6MSG)                                     01911
         LR    R0,R4                                                    01912
         MH    R0,TRKSPCYL                                              01913
         STH   R0,HOOKNTRK                                              01914
         B     F6RETURN                                                 01915
         SPACE 1                                                        01916
         DROP  R8                                                       01917
         EJECT                                                          01918
         SPACE 3                                                        01919
HOOKUP   TM    PARMOPT1,MAPOPT+EXTNTOPT+DIRFLAG                         01920
         BZR   R14                                                      01921
         ST    R14,HOSAVE                                               01922
         STM   R3,R5,HOSAVE+4                                           01923
         LA    R4,EXTNTLEN                                              01924
         BAL   R14,GETCORE                                              01925
         USING EXTENT,R3                                                01926
         MVC   EXTENT(EXTNTLEN),0(R2)                                   01927
         L     R2,HOOKSTRT                                              01928
         LA    R4,HOOKSTRT                                              01929
HOOKLOOK CLC   EXTLCCHH,EXTLCCHH-EXTENT(R2)                             01930
         BL    HOOKDONE                                                 01931
         LR    R4,R2                                                    01932
         L     R2,0(R2)                                                 01933
         B     HOOKLOOK                                                 01934
         SPACE 1                                                        01935
HOOKDONE ST    R2,EXTPTR                                                01936
         ST    R3,EXTPTR-EXTENT(R4)                                     01937
         LR    R15,R3                                                   01938
         LM    R3,R5,HOSAVE+4                                           01939
         L     R14,HOSAVE                                               01940
         BR    R14                                                      01941
         SPACE 1                                                        01942
         DROP  R3                                                       01943
         EJECT ,                                                        01944
         SPACE 3                                                        01945
CCHHCONV SR    R0,R0                                                    01946
         IC    R0,0(R2)                                                 01947
         MH    R0,DEVCONV1                                              01948
         SR    R1,R1                                                    01949
         IC    R1,1(R2)                                                 01950
         MH    R1,DEVCONV2                                              01951
         AR    R0,R1                                                    01952
         SR    R1,R1                                                    01953
         IC    R1,2(R2)                                                 01954
         MH    R1,DEVCONV3                                              01955
         AR    R0,R1                                                    01956
         SR    R1,R1                                                    01957
         IC    R1,3(R2)                                                 01958
         MH    R1,DEVCONV4                                              01959
         AR    R0,R1                                                    01960
         BR    R15                                                      01961
         SPACE 4                                                        01962
TTCONVRT SR    R0,R0                                                    01963
         ST    R0,CCHH                                                  01964
         LH    R15,DEVCONV1                                             01965
         LTR   R15,R15                                                  01966
         BZ    TTCONVR2                                                 01967
         DR    R0,R15                                                   01968
         STC   R1,CCHH                                                  01969
         LR    R1,R0                                                    01970
         SR    R0,R0                                                    01971
TTCONVR2 LH    R15,DEVCONV2                                             01972
         LTR   R15,R15                                                  01973
         BZ    TTCONVR3                                                 01974
         DR    R0,R15                                                   01975
         STC   R1,CCHH+1                                                01976
         LR    R1,R0                                                    01977
         SR    R0,R0                                                    01978
TTCONVR3 LH    R15,DEVCONV3                                             01979
         LTR   R15,R15                                                  01980
         BZ    TTCONVR4                                                 01981
         DR    R0,R15                                                   01982
         STC   R1,CCHH+2                                                01983
         STC   R0,CCHH+3                                                01984
         BR    R14                                                      01985
         SPACE 1                                                        01986
TTCONVR4 STC   R1,CCHH+3                                                01987
         BR    R14                                                      01988
         EJECT                                                          01989
         SPACE 3                                                        01990
CONVERT1 LA    R3,1                                                     01991
         B     CONVCOM                                                  01992
         SPACE 1                                                        01993
CONVERT2 LA    R3,2                                                     01994
         B     CONVCOM                                                  01995
         SPACE 1                                                        01996
CONVERT3 LA    R3,3                                                     01997
         B     CONVCOM                                                  01998
         SPACE 1                                                        01999
CONVERT4 LA    R3,4                                                     02000
         SPACE 1                                                        02001
CONVCOM  SR    R0,R0                                                    02002
CONV1MOR SLL   R0,8                                                     02003
         IC    R0,0(R2)                                                 02004
         LA    R2,1(R2)                                                 02005
         BCT   R3,CONV1MOR                                              02006
         SPACE 1                                                        02007
CONVERT  LPR   R0,R0                                                    02008
         CVD   R0,CONVDEC                                               02009
         UNPK  CONVUNPK,CONVDEC                                         02010
         OI    CONVUNPK+11,X'F0'                                        02011
         MVC   CONVEDIT,=X'402020202020202020202120'                    02012
         ED    CONVEDIT,CONVDEC+2                                       02013
         MVC   CONVERTD,CONVEDIT+1                                      02014
CONVCLI  CLI   CONVERTD,C' '                                            02015
         BNER  R14                                                      02016
         MVC   CONVERTD,CONVERTD+1                                      02017
         B     CONVCLI                                                  02018
         SPACE 1                                                        02019
         EJECT                                                          02020
         SPACE 3                                                        02021
DATEDIT  ST    R14,DASAVE                                               02022
         STM   R2,R5,DASAVE+4                                           02023
         XC    DATEWORD,DATEWORD                                        02024
         LTR   R2,R2                                                    02025
         BZ    DATGET                                                   02026
         SR    R1,R1                                                    02027
         IC    R1,0(R2)                                                 02028
         MH    R1,=H'1000'                                              02029
         MVC   DATEWORD,1(R2)                                           02030
         AH    R1,DATEWORD                                              02031
         CVD   R1,DATEWORD                                              02032
DATGETRT OI    DATEWORD+7,X'0F'                                         02033
         L     R2,DATEWORD+4                                            02034
         SR    R0,R0                                                    02035
         D     R0,=F'1000'                                              02036
         LA    R15,DATNORMY                                             02037
         LTR   R14,R1                                                   02038
         BZ    DATCOMP                                                  02039
         N     R14,=F'3'                                                02040
         BM    DATCOMP                                                  02041
         LA    R15,DATLEAPY                                             02042
         SPACE 1                                                        02043
DATCOMP  LTR   R0,R0                                                    02044
         BZ    DAJULIAN                                                 02045
         CH    R0,0(R15)                                                02046
         BH    DAJULIAN                                                 02047
         TM    PARMOPT2,JDATEOPT                                        02048
         BO    DAJULIAN                                                 02049
         LA    R3,1                                                     02050
         SR    R14,R14                                                  02051
         SPACE 1                                                        02052
DATICMON IC    R14,1(R3,R15)                                            02053
         CR    R0,R14                                                   02054
         BNH   DATMONOK                                                 02055
         SR    R0,R14                                                   02056
         LA    R3,1(R3)                                                 02057
         B     DATICMON                                                 02058
         SPACE 1                                                        02059
DATMONOK MH    R3,=H'1000'                                              02060
         AR    R3,R0                                                    02061
         MH    R3,=H'1000'                                              02062
         AR    R3,R1                                                    02063
         CVD   R3,DATEWORD                                              02064
         MVC   DATEWORD(5),DATEWORD+3                                   02065
         UNPK  DATEWORD(8),DATEWORD(5)                                  02066
         OI    DATEWORD+7,X'F0'                                         02067
         MVI   DATEWORD+2,C'/'                                          02068
         MVI   DATEWORD+5,C'/'                                          02069
         SPACE 3                                                        02070
DATRETRN LM    R2,R5,DASAVE+4                                           02071
         MVC   0(8,R3),DATEWORD                                         02072
         L     R14,DASAVE                                               02073
         BR    R14                                                      02074
         SPACE 2                                                        02075
DAJULIAN ST    R2,DATEWORD                                              02076
         UNPK  DATEWORD+2(5),DATEWORD+1(3)                              02077
         MVC   DATEWORD+1(2),DATEWORD+2                                 02078
         MVI   DATEWORD,C' '                                            02079
         MVI   DATEWORD+3,C'.'                                          02080
         MVI   DATEWORD+7,C' '                                          02081
         B     DATRETRN                                                 02082
         SPACE 2                                                        02083
DATGET   ST    R1,DATEWORD+4                                            02084
         LTR   R1,R1                                                    02085
         BNZ   DATGOT                                                   02086
         TIME  DEC                                                      02087
         ST    R1,DATEWORD+4                                            02088
DATGOT   CVB   R1,DATEWORD                                              02089
         B     DATGETRT                                                 02090
         SPACE 2                                                        02091
         EJECT                                                          02092
         SPACE 3                                                        02093
DUMPDSCB ST    R14,DUSAVE                                               02094
         LR    R4,R2                                                    02095
         LA    R2,3                                                     02096
         BAL   R14,PRLKAHED                                             02097
         LR    R2,R4                                                    02098
         MVC   BUF+8(17),=C'BLK 1234.5678.90:'                          02099
         UNPK  TRAREA,3(8,R3)                                           02100
         TR    TRAREA,TRTABLE                                           02101
         MVC   BUF+12(4),TRAREA                                         02102
         MVC   BUF+17(4),TRAREA+4                                       02103
         MVC   BUF+22(2),TRAREA+8                                       02104
         LA    R3,0(R2)                                                 02105
         LA    R4,BUF+35                                                02106
         LA    R5,44                                                    02107
         BAL   R14,DUMPLINE                                             02108
         MVI   BUF,SPACE1AP                                             02109
         BAL   R14,PRINT                                                02110
         MVC   BUF+8(13),=C'FORMAT N DSCB'                              02111
         MVC   BUF+15(1),44(R2)                                         02112
         OI    BUF+15,X'F0'                                             02113
         LA    R3,44(R2)                                                02114
         LA    R4,BUF+26                                                02115
         LA    R5,48                                                    02116
         BAL   R14,DUMPLINE                                             02117
         MVI   BUF,SPACE1AP                                             02118
         BAL   R14,PRINT                                                02119
         LA    R3,92(R2)                                                02120
         LA    R4,BUF+26                                                02121
         LA    R5,48                                                    02122
         BAL   R14,DUMPLINE                                             02123
         MVI   BUF,SPACE2AP                                             02124
         BAL   R14,PRINT                                                02125
         L     R14,DUSAVE                                               02126
         BR    R14                                                      02127
         EJECT ,                                                        02128
         SPACE 3                                                        02129
DUMPLINE LTR   R5,R5                                                    02130
         BNPR  R14                                                      02131
         B     DUMPNEXT                                                 02132
DUMPWORD BCT   R1,DUMPBYTE                                              02133
         MVI   0(R4),C' '                                               02134
         LA    R4,1(R4)                                                 02135
DUMPNEXT LA    R1,4                                                     02136
DUMPBYTE UNPK  TRAREA(3),0(2,R3)                                        02137
         TR    TRAREA(2),TRTABLE                                        02138
         MVC   0(2,R4),TRAREA                                           02139
         LA    R3,1(R3)                                                 02140
         LA    R4,2(R4)                                                 02141
         BCT   R5,DUMPWORD                                              02142
         BR    R14                                                      02143
         EJECT                                                          02144
         SPACE 3                                                        02145
GETCORE  A     R4,=F'3'                                                 02146
         N     R4,=F'-4'                                                02147
GETAGAIN L     R0,CORLEFT                                               02148
         SR    R0,R4                                                    02149
         BM    GETMAIN                                                  02150
         ST    R0,CORLEFT                                               02151
         L     R3,CORNEXT@                                              02152
         LR    R0,R3                                                    02153
         AR    R0,R4                                                    02154
         ST    R0,CORNEXT@                                              02155
         BR    R14                                                      02156
         SPACE 3                                                        02157
GETMAIN  L     R3,CURBLK@                                               02158
         GETMAIN EC,LV=2048,A=CURBLK@                                   02159
         BXH   R15,R15,ERRNOCOR                                         02160
         SPACE 1                                                        02161
         L     R1,CURBLK@                                               02162
         ST    R1,0(R3)                                                 02163
         SR    R0,R0                                                    02164
         ST    R0,0(R1)                                                 02165
         LA    R1,4(R1)                                                 02166
         ST    R1,CORNEXT@                                              02167
         MVC   CORLEFT,=A(2044)                                         02168
         B     GETAGAIN                                                 02169
         EJECT ,                                                        02170
         SPACE 3                                                        02171
FREECORE L     R2,CORFRST@                                              02172
FREELOOP LTR   R1,R2                                                    02173
         BZ    FREEDONE                                                 02174
         L     R2,0(R2)                                                 02175
         LA    R0,2048                                                  02176
         FREEMAIN R,LV=(0),A=(1)                                        02177
         B     FREELOOP                                                 02178
         SPACE 1                                                        02179
FREEDONE SR    R0,R0                                                    02180
         ST    R0,CORLEFT                                               02181
         ST    R0,CORFRST@                                              02182
         LA    R0,CORFRST@                                              02183
         ST    R0,CURBLK@                                               02184
         BR    R14                                                      02185
         EJECT                                                          02186
         SPACE 3                                                        02187
PRINT    ST    R14,PRSAVE                                               02188
         STM   R2,R5,PRSAVE+4                                           02189
         LH    R0,CURLINES                                              02190
         CH    R0,MAXLINES                                              02191
         BL    PRNOPAGE                                                 02192
         PUT   PRINTDCB,NEWPAGE                                         02193
         SR    R0,R0                                                    02194
         STH   R0,CURLINES                                              02195
PRNOPAGE LTR   R0,R0                                                    02196
         BNZ   PRINTBUF                                                 02197
         LH    R0,CURPAGES                                              02198
         AH    R0,=H'1'                                                 02199
         STH   R0,CURPAGES                                              02200
         CH    R0,MAXPAGES                                              02201
         BNH   PRTPGCNV                                                 02202
         SR    R0,R0                                                    02203
         STH   R0,CURPAGES                                              02204
PRTPGCNV BAL   R14,CONVERT                                              02205
         MVC   PAGENO,CONVERTD                                          02206
         PUT   PRINTDCB,HEADERCC                                        02207
         MVC   CURLINES,=H'3'                                           02208
         L     R2,BUFPTR                                                02209
PRNXTBUF LH    R0,CURLINES                                              02210
         LTR   R2,R2                                                    02211
         BZ    PRINTBUF                                                 02212
         AH    R0,4(R2)                                                 02213
         STH   R0,CURLINES                                              02214
         LA    R3,6(R2)                                                 02215
         PUT   PRINTDCB,(3)                                             02216
         L     R2,0(R2)                                                 02217
         B     PRNXTBUF                                                 02218
         EJECT                                                          02219
         SPACE 3                                                        02220
PRINTBUF TM    BUF,X'80'                                                02221
         BZ    PRUPLINE                                                 02222
         SR    R0,R0                                                    02223
         B     PRDOPUT                                                  02224
PRUPLINE SR    R14,R14                                                  02225
         IC    R14,BUF                                                  02226
         SRL   R14,3                                                    02227
         AR    R0,R14                                                   02228
PRDOPUT  STH   R0,CURLINES                                              02229
         PUT   PRINTDCB,BUF                                             02230
         TM    BUF,X'02'                                                02231
         BO    PRETURN                                                  02232
         MVI   BUF+1,C' '                                               02233
         MVC   BUF+2(131),BUF+1                                         02234
         SPACE 1                                                        02235
PRETURN  LM    R2,R5,PRSAVE+4                                           02236
         L     R14,PRSAVE                                               02237
         BR    R14                                                      02238
         SPACE 4                                                        02239
PRLKAHED AH    R2,CURLINES                                              02240
         CH    R2,MAXLINES                                              02241
         BNHR  R14                                                      02242
         MVC   CURLINES,=H'999'                                         02243
         BR    R14                                                      02244
         EJECT                                                          02245
         SPACE 1                                                        02246
RETURN   CLOSE (PRINTDCB)                                               02247
         SPACE 1                                                        02248
         TM    DCBBUFCB+3+(PRINTDCB-IHADCB),X'01'                       02249
         BO    RETQUIT                                                  02250
         FREEPOOL PRINTDCB                                              02251
         SPACE 1                                                        02252
RETQUIT  CLI   HDNGLIST,X'FF'                                           02253
         BNE   RETSAVER                                                 02254
         L     R1,HDNGLIST                                              02255
         LH    R2,0(R1)                                                 02256
         LH    R0,CURPAGES                                              02257
         AH    R0,=H'1'                                                 02258
         BAL   R14,CONVERT                                              02259
         LA    R3,CONVEDIT+12                                           02260
         SR    R3,R2                                                    02261
         BCTR  R2,0                                                     02262
         STC   R2,*+5                                                   02263
         MVC   2(*-*,R1),0(R3)                                          02264
         SPACE 1                                                        02265
RETSAVER L     R13,SAVEAREA+4                                           02266
         L     R15,RETCODE                                              02267
         L     R14,12(R13)                                              02268
         LM    R0,R12,20(R13)                                           02269
         MVI   12(R13),X'FF'                                            02270
         SPM   R14                                                      02271
         BR    R14                                                      02272
         SPACE 3                                                        02273
ABDUMP   OI    ABCODE,X'80'        SET DUMP FLAG                        02274
         SPACE 1                                                        02275
ABEND    L     R1,ABCODE           PICK UP ABEND CODE                   02276
         ABEND (1)                                                      02277
         EJECT ,                                                        02278
NEWPAGE  DC    AL1(EJECTIM)                                             02279
HEADERCC DC    AL1(SPACE3AP)                                            02280
VOLSERNO DS    CL6                 CURRENT VOLUME SERIAL                02281
         ORG   VOLSERNO                                                 02282
HEADER DS 0CL95                                                         02283
       DC C'DIRECT-ACCESS VOLUME LISTING UTILITY....         W.S'       02284
       DC C'.R.C.C. VERSION--'                                          02285
       DC C'&SYSDATE'   8 CHARS                                         02286
       DC CL31' '                                                       02287
HEADMID  EQU   HEADER+19                                                02288
PRDATE   DC    CL8'03/15/84'                                            02289
         DC    CL6'  DAY='                                              02290
PRDAY    DC    CL3'999'                                                 02291
PRTIME   DC    CL7'  23:59',CL4' '                                      02292
         DC    CL5'PAGE '                                               02293
PAGENO   DC    CL4'9999'                                                02294
         SPACE 3                                                        02295
HEAD1    DC    C'TABLE OF CONTENTS FOR VOLUME "'                        02296
HEAD1VOL DC    CL6'XXXXXX',C'" ON DEVICE "'                             02297
HEAD1UCB DC    CL3'XXX',C'" MOUNTED AS "'                               02298
HEAD1MT  DC    CL8'XXXXXXXX',C'/'                                       02299
HEAD1MTR DC    CL5'XXXXX',C'"'                                          02300
HEAD1A   DC    A(HEAD1B)                                                02301
         DC    H'0'                                                     02302
HEADER1  DC    AL1(SPACE0AP),CL19' ',CL26'DSNAME'                       02303
HEADAT1A DC    C'   SERIAL  R/W  CREDT    EXPDT    DSO RECFM BLKSZ LRECX02304
               L KEY OP TRKAL TRKUS EX SECQU TYP'                       02305
HEAD1B   DC    A(0)                                                     02306
         DC    H'2'                                                     02307
HEADER2  DC    AL1(SPACE2AP),44C'_',C' '                                02308
HEADAT1B DC    C'   ______  ___ ________ ________  ___ _____ _____ ____X02309
               _ ___ __ _____ _____ __ _____ ___'                       02310
         SPACE 2                                                        02311
HEAD2    DC    C'TRACK ALLOCATION MAP FOR VOLUME "'                     02312
HEAD2VOL DC    C'XXXXXX',C'"'                                           02313
HEAD2A   DC    A(HEAD2B)                                                02314
         DC    H'0'                                                     02315
         DC    AL1(SPACE0AP),CL22' '                                    02316
HEAD2DAT DC    C'FIRST TRK   LAST TRK  FIRST   LAST  #TRKS  EX  EX-#  ' 02317
         DC    CL44'DSNAME OR USAGE'                                    02318
         DC    CL13' '                                                  02319
HEAD2B   DC    A(0)                                                     02320
         DC    H'2'                                                     02321
         DC    AL1(SPACE2AP),CL22' '                                    02322
HEAD2UND DC    C'_________  _________  _____  _____  _____  __  ____  ' 02323
         DC    44C'_'                                                   02324
         DC    CL13' '                                                  02325
         SPACE                                                          02326
DSNAMEL  DC    A(0)                                                JM#1 02327
         DC    H'2'                                                JM#1 02328
DSNAME2  DC    AL1(SPACE2AP),CL48' ',CL11'(CONTINUED)',CL77' '          02329
H1BOLD   DC    A(0)                                                JM#1 02330
H1BNEW   DC    A(DSNAMEL)                                          JM#1 02331
         SPACE                                                          02332
PDSMSG   DC    CL19'DIRECTORY CONTAINS'                                 02333
PDSVAL1  DC    CL4'0000'                                                02334
         DC    CL18' MEMBERS AND USES '                                 02335
PDSVAL2  DC    CL4'0000'                                                02336
         DC    CL8' OF THE '                                            02337
PDSVAL3  DC    CL4'0000'                                                02338
         DC    CL39' DIRECTORY BLOCKS ALLOCATED, INCLUDING '            02339
PDSVAL4  DC    CL3'000'                                                 02340
         DC    CL24' BYTES OF THE LAST BLOCK'                           02341
PDSMSGLN EQU   *-PDSMSG                                                 02342
         EJECT                                                          02343
         PRINT ON,NOGEN                                                 02344
         SPACE 2                                                        02345
VTOCDCB  DCB   DDNAME=VOLUME01,                                        X02346
               DSORG=PS,                                               X02347
               MACRF=(R),                                              X02348
               RECFM=FS,                                               X02349
               KEYLEN=44,                                              X02350
               BLKSIZE=96,                                             X02351
               OPTCD=C,                                                X02352
               NCP=NCPDFLT,                                            X02353
               EXLST=JFCBAD,                                           X02354
               EODAD=VTOCEOD,                                          X02355
               SYNAD=SYNADXIT                                           02356
         SPACE 6                                                        02357
PDSDCB   DCB   DDNAME=VOLUME01,                                        X02358
               DSORG=PS,                                               X02359
               MACRF=(R),                                              X02360
               RECFM=F,                                                X02361
               KEYLEN=8,                                               X02362
               BLKSIZE=256,                                            X02363
               EXLST=JFCBAD,                                           X02364
               EODAD=PDSEOD,                                           X02365
               SYNAD=SYNADXIT                                           02366
         SPACE 6                                                        02367
PRINTDCB DCB   DDNAME=SYSPRINT,                                        X02368
               DSORG=PS,                                               X02369
               EROPT=ACC,                                              X02370
               MACRF=(PM),                                             X02371
               RECFM=FBM,                                              X02372
               LRECL=133,                                              X02373
               BLKSIZE=133                                              02374
         SPACE 2                                                        02375
         PRINT ON,GEN                                                   02376
         EJECT                                                          02377
OPENLIST OPEN  (VTOCDCB,(INPUT)),MF=L                                   02378
OPENFLAG EQU   OPENLIST                                                 02379
OPENUPDT EQU   X'04'                                                    02380
         SPACE 2                                                        02381
CLOSLIST CLOSE (VTOCDCB),MF=L                                           02382
CLOSFLAG EQU   CLOSLIST                                                 02383
CLOSRERD EQU   X'10'                                                    02384
         SPACE 2                                                        02385
         READ  VTOCDECB,SF,VTOCDCB,CAMLIST,MF=L                         02386
         SPACE 2                                                        02387
         READ  PDSDECB,SF,PDSDCB,MF=L                                   02388
         SPACE 2                                                        02389
ENQVTOC  RESERVE (SYSVTOC,VOLSERNO,S,6,SYSTEMS),UCB=UCBADDR,MF=L        02390
ENQFLAGS EQU   ENQVTOC+2                                                02391
ENQSHAR  EQU   X'80'                                                    02392
         SPACE 1                                                        02393
SYSVTOC  DC    CL8'SYSVTOC'                                             02394
         EJECT                                                          02395
DATEWORD DC    D'0'                                                     02396
CONVDEC  DC    D'0'                                                     02397
CONVEDIT DC    CL12' '                                                  02398
CONVERTD DC    CL11' ',C' '                                             02399
CONVUNPK DC    CL12' '                                                  02400
NOMAPDDS DC    C'JOBLIB  '                                              02401
         DC    C'STEPCAT '                P.A.S.                        02402
         DC    C'JOBCAT  '                P.A.S.                        02403
         DC    C'STEPLIB '                                              02404
         DC    C'SYSCHK  '                                              02405
         DC    C'PGM=*.DD'                                              02406
         DC    C'SYSIN   '                                              02407
         DC    C'SYSPRINT'                                              02408
         DC    C'SYSABEND'                                              02409
         DC    C'SYSUDUMP'                                              02410
         DC    C'        '                                              02411
VOLDDNAM DC    C'VOLUME00'                                              02412
         ORG   *-2                                                      02413
CURVOLNM DC    C'00'                                                    02414
TIME     DC    F'0'                                                     02415
PARMLIST DC    A(0)                                                     02416
DDNMLIST DC    A(0)                                                     02417
HDNGLIST DC    A(0)                                                     02418
DDLSTPTR DC    A(0)                                                     02419
         SPACE 1                                                        02420
EXTRACT  EQU   *                                                        02421
TIOTAD   DC    A(0)                                                     02422
COMPTR   DC    A(0)                                                     02423
         SPACE 1                                                        02424
TIOTADDD DC    A(0)                                                     02425
PDSBLKAD DC    A(PDSBLOCK,PDSBLOCK+PDSBLKLN)                            02426
CCHH     DC    F'0'                                                     02427
BUFPTR   DC    A(0)                                                     02428
HOOKSTRT DC    A(*)                                                     02429
HOOKEND  DC    F'-1'                                                    02430
DATNORMY DC    H'365',AL1(31,28,31,30,31,30,31,31,30,31,30,31)          02431
DATLEAPY DC    H'366',AL1(31,29,31,30,31,30,31,31,30,31,30,31)          02432
CORLEFT  DC    F'0'                                                     02433
CORNEXT@ DC    A(0)                                                     02434
CURBLK@  DC    A(*+4)                                                   02435
CORFRST@ DC    A(0)                                                     02436
CURLINES DC    H'999'                                                   02437
MAXPAGES DC    H'9999'                                                  02438
MAXLINES DC    H'60'                                                    02439
CURPAGES DC    H'0'                                                     02440
JFCBAD   DC    X'87',AL3(JFCB)                                          02441
RETCODE  DC    F'0'                                                     02442
ABCODE   DC    F'100'              ABEND CODE 100                       02443
SAVEAREA DC    18F'0'                                                   02444
CURVOL   DC    H'0'                                                     02445
DDNAMLEN DC    H'0'                                                     02446
NUMVOLS  DC    H'-1'                                                    02447
NCPPARM  DC    AL2(NCPDFLT)                                             02448
TRAREA   DC    CL15' ',C' '                                             02449
EFFS     DC    44X'FF'                                                  02450
LASTDS1  EQU   EFFS                                                     02451
ZEROES   DC    44X'00'                                                  02452
PARMOPT1 DC    AL1(00)    SET DEFAULT TO NO OPTIONS                     02453
PARMOPT2 DC    AL1(0)                                                   02454
TRTABLE  EQU   *-240                                                    02455
         DC    C'0123456789ABCDEF'                                      02456
STARS    DC    C'*********'                                             02457
VOLSTAT  DC    X'00'                                                    02458
         DC    0F'0'                                                    02459
HOOKINIT DC    2XL4'00'                                                 02460
         DC    H'1'                                                     02461
         DC    X'FF00'                                                  02462
         DC    A(VOLABMSG)                                              02463
         DC    F'0'                                                     02464
         EJECT                                                          02465
         SPACE 3                                                        02466
DEVTABLE DC    X'06',CL15'2305-1 DRUM'                                  02467
*                                                                       02468
         DC    X'07',CL15'2305-2 DRUM'                                  02469
*                                                                       02470
         DC    X'08',CL15'2314 DISK PACK'                               02471
*                                                                       02472
         DC    X'09',CL15'3330 DISK PACK'                               02473
*                                                                       02474
         DC    X'0D',CL15'3330-II DISK'     ADDED 4/1/75  P.A.S.        02475
*                                                                       02476
         DC    X'0A',CL15'3340-35M DISK'   ADDED 5/4/75  P.A.S.         02477
*                                                                       02478
         DC    X'0B',CL15'3350 DISK PACK'  ADDED 01/10/77 G.D.F.        02479
*                                                                       02480
         DC    X'0E',CL15'3380 DISK PACK'  ADDED 08/13/82          JM#2 02481
*                                                                       02482
DEVTABND DC    X'00',CL7'UNKNOWN'                                       02483
         SPACE 1                                                        02484
DEVENTLN EQU   16                                                       02485
         EJECT                                                          02486
         LTORG                                                          02487
         SPACE 1                                                        02488
VOLABMSG DC    CL44'  **** VOLUME LABEL ****'                           02489
VTOCMSG  DC    CL44'  **** VOLUME TABLE OF CONTENTS ****'               02490
FMT6MSG  DC    CL44'SPLIT CYLINDER(S) SHARED BY NEXT XXX EXTENTS'       02491
         SPACE 3                                                        02492
STORAGES DS    0D                                                       02493
         EJECT                                                          02494
BUF      DS    CL133                                                    02495
         SPACE 2                                                        02496
         ORG   BUF+1                                                    02497
L1       DS    0CL132                                                   02498
L1DSNAME DS    CL44                                                     02499
         DS    CL4                                                      02500
L1SERIAL DS    CL6                                                      02501
L1VOLSQ  DS    C                                                        02502
         DS    C                                                        02503
L1SECUR  DS    CL3                                                      02504
         DS    C                                                        02505
L1CREDT  DS    CL8                                                      02506
         DS    C                                                        02507
L1EXPDT  DS    CL8                                                      02508
         DS    2C                                                       02509
L1DSORG  DS    CL3                                                      02510
         DS    C                                                        02511
L1RECFM  DS    CL5                                                      02512
         DS    C                                                        02513
L1BLKSIZ DS    CL5                                                      02514
         DS    C                                                        02515
L1LRECL  DS    CL5                                                      02516
         DS    C                                                        02517
L1KEYLEN DS    CL3                                                      02518
         DS    C                                                        02519
L1OPTCD  DS    CL2                                                      02520
         DS    C                                                        02521
L1TRKAL  DS    CL5                                                      02522
         DS    C                                                        02523
L1TRKUS  DS    CL5                                                      02524
         DS    C                                                        02525
L1NOEPV  DS    CL2                                                      02526
         DS    C                                                        02527
L1SECQU  DS    CL5                                                      02528
         DS    C                                                        02529
L1TYP    DS    CL3                                                      02530
         SPACE 1                                                        02531
         ORG   L1SERIAL                                                 02532
L1LSTDT  DS    CL8                                                      02533
         DS    C                                                        02534
L1USCNT  DS    CL5                                                      02535
         ORG   ,                                                        02536
         EJECT                                                          02537
PRSAVE   DS    5A                                                       02538
DASAVE   DS    5A                                                       02539
         DS    0D                                                       02540
PDSBLOCK DS    2XL(PDSBLKLN)                                            02541
CAMLIST  DS    XL(CAMLSTLN)                                             02542
         SPACE 1                                                        02543
START0   DS    0H                  START OF CORE ZEROED FOR EACH VOL    02544
         SPACE 1                                                        02545
DEVTYPE  DS    6F                                                       02546
UCBADDR  DS    A                                                        02547
FIRSTDS1 DS    A                                                        02548
FMT4AD   DS    A                                                        02549
FMT5AD   DS    A                                                        02550
FMT6AD   DS    A                                                        02551
FMT5TT   DS    H                                                        02552
FMT5CYLS DS    H                                                        02553
         SPACE 1                                                        02554
REBLOCK@ DS    F                                                        02555
RENEXT@  DS    F                                                        02556
REBLKSIZ DS    F                                                        02557
RECOUNT  DS    F                                                        02558
RENCP    DS    F                                                        02559
REGETSIZ DS    F                                                        02560
         SPACE 1                                                        02561
FMXCOUNT DS    0H                  COUNT FIELDS MUST BE TOGETHER        02562
FM0COUNT DS    H                                                        02563
FM1COUNT DS    H                                                        02564
FM2COUNT DS    H                                                        02565
FM3COUNT DS    H                                                        02566
FM4COUNT DS    H                                                        02567
FM5COUNT DS    H                                                        02568
FM6COUNT DS    H                                                        02569
         SPACE 1                                                        02570
AVAILCYL DS    H                                                        02571
AVAILSPC DS    H                                                        02572
AVAILEXT DS    H                                                        02573
VTOCSIZE DS    H                                                        02574
LOWTT    DS    H                                                        02575
HIGHTT   DS    H                                                        02576
         SPACE 1                                                        02577
HOOKPTR  DS    F                                                        02578
HOOKLCCH DS    XL4                                                      02579
HOOKHCCH DS    XL4                                                      02580
HOOKNTRK DS    H                                                        02581
HOOKTYPE DS    X                                                        02582
HOOKSEQN DS    X                                                        02583
HOOKIDPT DS    A                                                        02584
HOOKLOTT DS    XL2                                                      02585
HOOKHITT DS    XL2                                                      02586
         SPACE 1                                                        02587
F1TRKAL  DS    F                                                        02588
DEVTABPT DS    A                   POINTER TO CURRENT DEVTABLE ENTRY    02589
DEVCONV1 DS    H                   CURRENT DEVTABLE INFO                02590
DEVCONV2 DS    H                                                        02591
DEVCONV3 DS    H                                                        02592
DEVCONV4 DS    H                                                        02593
TRKSPCYL DS    H                                                        02594
TRKSPVOL DS    H                                                        02595
CRATRACK DS    H              REL TRACK ADDRESS OF VSAM CRA             02596
HWMOLD   DS    XL5                                                      02597
HWMDS1   DS    XL5                                                      02598
HWMNEW   DS    XL5                                                      02599
HWMINDIC DS    X                                                        02600
F5LARGST DS    XL3                                                      02601
SYNADFLG DS    X                                                        02602
OBCCHHR  DS    XL5                                                      02603
BADDSTYP DS    C                                                        02604
F5LARGTT DS    H                                                        02605
         SPACE 1                                                        02606
         DS    0H                                                       02607
VTOCTTR  DS    0XL3                                                     02608
VTOCTT   DS    H                                                        02609
VTOCR    DS    X                                                        02610
VTOCMBB  DS    0XL3                                                     02611
VTOCM    DS    X                                                        02612
VTOCBIN  DS    H                                                        02613
VTOCCCHH DS    XL4                                                      02614
VTDSCBTR DS    H                                                        02615
         SPACE 1                                                        02616
END0     DS    0H                  END OF CORE ZEROED FOR EACH VOL      02617
LENGTH0  EQU   END0-START0         AMOUNT TO BE ZEROED                  02618
         SPACE 1                                                        02619
NUMEXT   DS    H                                                        02620
LISTEXT  DS    17A                                                      02621
PDSAVE   DS    6A                                                       02622
PDSENTAD DS    A                                                        02623
PDSBYTCT DS    H                                                        02624
PDSBLKAL DS    H                                                        02625
PDSBLKUS DS    H                                                        02626
PDSMEMCT DS    H                                                        02627
ISAVE    DS    5A                                                       02628
EXPFLAG  DS    X                                                        02629
EXSAVE   DS    3A                                                       02630
VTSAVE   DS    4A                                                       02631
F1SAVE   DS    A                                                        02632
F5SAVE   DS    6A                                                       02633
HOSAVE   DS    4A                                                       02634
DUSAVE   DS    A                                                        02635
         EJECT ,                                                        02636
         IEFJFCBN                                                       02637
         SPACE 1                                                        02638
JFCB     EQU   INFMJFCB                                                 02639
         SPACE 3                                                        02640
         ORG   STORAGES                                                 02641
         EJECT                                                          02642
         SPACE 1                                                        02643
INIT     L     R2,0(R1)                                                 02644
         ST    R2,PARMLIST                                              02645
         LTR   R2,R2                                                    02646
         BM    GETTIME                                                  02647
         L     R2,4(R1)                                                 02648
         ST    R2,DDNMLIST                                              02649
         LTR   R2,R2                                                    02650
         BM    CHEKDDNM                                                 02651
         L     R2,8(R1)                                                 02652
         ST    R2,HDNGLIST                                              02653
         SPACE 1                                                        02654
         LA    R2,0(R2)                                                 02655
         LTR   R2,R2                                                    02656
         BZ    CHEKDDNM                                                 02657
         LH    R3,0(R2)                                                 02658
         LA    R2,2(R2)                                                 02659
         BAL   R14,PARMPARS                                             02660
         LTR   R0,R0                                                    02661
         BNP   CHEKDDNM                                                 02662
         CH    R0,=H'9999'                                              02663
         BH    CHEKDDNM                                                 02664
         BCTR  R0,0                                                     02665
         STH   R0,CURPAGES                                              02666
         MVI   HDNGLIST,X'FF'                                           02667
         SPACE 1                                                        02668
CHEKDDNM TM    PARMLIST,X'80'                                           02669
         BO    GETTIME                                                  02670
         L     R1,DDNMLIST                                              02671
         LH    R0,0(R1)                                                 02672
         SH    R0,=H'8'                                                 02673
         BM    GETTIME                                                  02674
         OI    DDNMLIST,X'F0'                                           02675
         STH   R0,DDNAMLEN                                              02676
         MVC   DCBDDNAM+(PRINTDCB-IHADCB),2(R1)                         02677
         SH    R0,=H'8'                                                 02678
         BM    GETTIME                                                  02679
         LA    R1,10(R1)                                                02680
         ST    R1,DDLSTPTR                                              02681
         OI    DDNMLIST,X'0F'                                           02682
         SPACE 1                                                        02683
GETTIME  TIME  DEC                                                      02684
         SRL   R0,4                                                     02685
         ST    R0,TIME                                                  02686
         MVC   PRTIME,=X'402120207A2020'                                02687
         ED    PRTIME,TIME                                              02688
         ST    R1,DATEWORD+4                                            02689
         UNPK  TRAREA,DATEWORD+6(8)                                     02690
         TR    TRAREA,TRTABLE                                           02691
         MVC   PRDAY,TRAREA                                             02692
         SR    R2,R2                                                    02693
         LA    R3,PRDATE                                                02694
         BAL   R14,DATEDIT                                              02695
         SPACE 1                                                        02696
         OPEN  (PRINTDCB,(OUTPUT))                                      02697
         TM    DCBOFLGS+(PRINTDCB-IHADCB),DCBOFOPN                      02698
         BNZ   *+8                                                      02699
         BAL   R14,ABEND                                                02700
         MVI   BUF,C' '                                                 02701
         MVC   BUF+1(L'BUF-1),BUF                                       02702
         SPACE 1                                                        02703
         EXTRACT EXTRACT,FIELDS=(TIOT,COMM)                             02704
         L     R1,TIOTAD                                                02705
         LA    R1,TIOENTRY-TIOT(,R1)                                    02706
         ST    R1,TIOTADDD                                              02707
         SPACE 1                                                        02708
         MVC   BUF+10(21),=C'EXEC PARAMETER FIELD:'                     02709
         L     R1,COMPTR                                                02710
         L     R1,COMCIBPT-COM(,R1)                                     02711
TESTCIB  LA    R1,0(,R1)                                                02712
         LTR   R1,R1                                                    02713
         BZ    PARMEX                                                   02714
         USING CIB,R1                                                   02715
         CLI   CIBVERB,CIBSTART                                         02716
         BE    PARMCIB                                                  02717
         L     R1,CIBNEXT                                               02718
         B     TESTCIB                                                  02719
         SPACE 1                                                        02720
PARMCIB  LA    R1,CIBDATLN                                              02721
         ST    R1,PARMLIST                                              02722
         DROP  R1                                                       02723
         MVC   BUF+9(5),=C'START'                                       02724
         SPACE 1                                                        02725
PARMEX   L     R2,PARMLIST                                              02726
         LH    R3,0(R2)                                                 02727
         LA    R2,2(R2)                                                 02728
         CH    R3,=H'99'                                                02729
         BL    PARMLNOK                                                 02730
         MVC   BUF+30(28),=C' IS TOO LONG AND WAS IGNORED'              02731
         SR    R3,R3                                                    02732
         B     PARMPRNT                                                 02733
         SPACE 1                                                        02734
PARMLNOK LTR   R1,R3                                                    02735
         BZ    PARMPRNT                                                 02736
         BCTR  R1,0                                                     02737
         STC   R1,*+5                                                   02738
         MVC   BUF+33(*-*),0(R2)                                        02739
PARMPRNT MVI   BUF,SPACE3AP                                             02740
         BAL   R14,PRINT                                                02741
         SPACE 1                                                        02742
PARMLOOP BAL   R14,PARMPARS                                             02743
         TM    PARMOPT2,VOLSOPT                                         02744
         BO    PARMVOL2                                                 02745
         TM    PARMOPT2,LNCNTOPT                                        02746
         BO    PARMLCT2                                                 02747
         TM    PARMOPT2,NCPOPT                                          02748
         BO    PARMNCP2                                                 02749
         CLI   PARMBUF,C' '                                             02750
         BE    PARMDONE                                                 02751
         SPACE 1                                                        02752
         LA    R0,12                                                    02753
         LA    R1,PARMS                                                 02754
PARMCOMP CLC   PARMBUF,0(R1)                                            02755
         BE    GOTPARM                                                  02756
         BXH   R1,R0,PARMCOMP                                           02757
         SPACE 1                                                        02758
GOTPARM  MVC   PARMVALS,8(R1)                                           02759
         MVC   *+8(2),10(R1)                                            02760
         B     *-*                                                      02761
         SPACE 1                                                        02762
PARMSET  SR    R15,R15                                                  02763
         IC    R15,PARMVALS+1                                           02764
         LA    R15,PARMOPT1(R15)                                        02765
         SR    R0,R0                                                    02766
         IC    R0,PARMVALS                                              02767
         CLI   PARMVALS,128                                             02768
         BH    PARMOFF                                                  02769
         STC   R0,*+5                                                   02770
         OI    0(R15),*-*                                               02771
         B     PARMLOOP                                                 02772
         SPACE 1                                                        02773
PARMOFF  STC   R0,*+5                                                   02774
         NI    0(R15),*-*                                               02775
         B     PARMLOOP                                                 02776
         SPACE 1                                                        02777
DEBUGON  OI    CLOSLIST,CLOSRERD                                        02778
         B     PARMSET                                                  02779
         SPACE 1                                                        02780
DEBUGOFF NI    CLOSLIST,255-CLOSRERD                                    02781
         B     PARMSET                                                  02782
         SPACE 1                                                        02783
PDSON    L     R15,TIOTAD                                               02784
*        CLI   TIOCNJOB+3-TIOT(R15),C'$'    DELETED  4/1/75  P.A.S.     02785
*        BNE   PARMERR      DELETED  4/1/75   P.A.S.                    02786
         B     PARMSET                                                  02787
         SPACE 1                                                        02788
RESETON  NI    ENQFLAGS,255-ENQSHAR                                     02789
         OI    CLOSLIST,CLOSRERD                                        02790
         B     PARMSET                                                  02791
         SPACE 1                                                        02792
RESETOFF OI    ENQFLAGS,ENQSHAR                                         02793
         NI    CLOSLIST,255-CLOSRERD                                    02794
         B     PARMSET                                                  02795
         SPACE 1                                                        02796
PARMVOL2 NI    PARMOPT2,255-VOLSOPT                                     02797
         LTR   R0,R0                                                    02798
         BNP   PARMERR                                                  02799
         CH    R0,=H'99'                                                02800
         BH    PARMERR                                                  02801
         STH   R0,NUMVOLS                                               02802
         B     PARMLOOP                                                 02803
         SPACE 1                                                        02804
PARMLCT2 NI    PARMOPT2,255-LNCNTOPT                                    02805
         LTR   R0,R0                                                    02806
         BNP   PARMERR                                                  02807
         CH    R0,=H'999'                                               02808
         BNL   PARMERR                                                  02809
         STH   R0,MAXLINES                                              02810
         B     PARMLOOP                                                 02811
         SPACE 1                                                        02812
PARMNCP2 NI    PARMOPT2,255-NCPOPT                                      02813
         LTR   R0,R0                                                    02814
         BNP   PARMERR                                                  02815
         CH    R0,=H'99'                                                02816
         BH    PARMERR                                                  02817
         STH   R0,NCPPARM                                               02818
         B     PARMLOOP                                                 02819
         SPACE 1                                                        02820
PARMERR  MVI   BUF+10,C'"'                                              02821
         MVC   BUF+11(8),PARMBUF                                        02822
         MVC   BUF+19(41),=C'" IS AN ILLEGAL PARAMETER AND WAS IGNORED' 02823
         MVI   BUF,SPACE3AP                                             02824
         BAL   R14,PRINT                                                02825
         B     PARMLOOP                                                 02826
         SPACE 1                                                        02827
PARMDONE OI    PARMOPT2,VOLSOPT                                         02828
         LH    R0,NUMVOLS                                               02829
         CH    R0,=H'-1'                                                02830
         BNE   PARMVOL#                                                 02831
         NI    PARMOPT2,255-VOLSOPT                                     02832
         MVC   NUMVOLS,=H'99'                                           02833
         MVC   BUF+10(3),=C'ALL'                                        02834
         B     PARMVLPR                                                 02835
         SPACE 1                                                        02836
PARMVOL# BAL   R14,CONVERT                                              02837
         MVC   BUF+10(3),CONVEDIT+9                                     02838
PARMVLPR MVC   BUF+14(24),=C'VOLUME(S) WILL BE LISTED'                  02839
         MVI   BUF,SPACE3AP                                             02840
         BAL   R14,PRINT                                                02841
         SPACE 1                                                        02842
         CLC   NCPPARM,=H'1'                                            02843
         BNE   *+8                                                      02844
         OI    PARMOPT2,NCPOPT                                          02845
         TM    PARMOPT1,LSTDTOPT                                        02846
         BZ    PARMDDCK                                                 02847
         MVC   HEADAT1A(14),=C' LSTDT   USCNT'                          02848
         MVC   HEADAT1B(14),=C'________ _____'                          02849
         SPACE 1                                                        02850
PARMDDCK TM    DDNMLIST,X'F0'                                           02851
         BNO   PARMHDCK                                                 02852
         MVC   BUF+10(36),=C'AN INTERNAL DDNAME LIST WILL BE USED'      02853
         TM    DDNMLIST,X'0F'                                           02854
         BO    *+10                                                     02855
         MVC   BUF+47(14),=C'FOR PRINT ONLY'                            02856
         MVI   BUF,SPACE3AP                                             02857
         BAL   R14,PRINT                                                02858
         SPACE 1                                                        02859
PARMHDCK CLI   HDNGLIST,X'FF'                                           02860
         BNE   PRTINFO      ADDED 4/1/75  P.A.S.  FOR 'HELP'            02861
         MVC   BUF+10(35),=C'AN INTERNAL PAGE COUNT WILL BE USED'       02862
         MVI   BUF,SPACE3AP                                             02863
         BAL   R14,PRINT                                                02864
         SPACE 3                                                        02865
PRTINFO  EQU   *                                                        02866
         LA    R3,PRTINFOL  POINT TO INFO LISTING                       02867
         LA    R2,PRTINFLN  NUMBER OF INFO LINES TO PRINT.         JM#1 02868
PRTINFOA MVC   BUF+9(50),0(R3)  MOVE LINE TO BUFFER                JM#1 02869
         MVI   BUF,SPACE1AP   INSERT CARRIAGE CONTROL                   02870
         LA    R3,50(R3)  INCREMENT TO NEXT LINE                   JM#1 02871
         BAL   R14,PRINT                                                02872
         BCT   R2,PRTINFOA GO AGAIN                                     02873
         MVI   BUF,SPACE3IM                                             02874
         BAL   R14,PRINT                                                02875
         MVC   BUF+9(33),=C'*** OPERATING SYSTEM RUN ON .... '          02876
         MVI   BUF,SPACE3AP                                             02877
         L     R3,16  POINT TO CVT                                      02878
         LA    R3,116(R3)   POINT TO OPERATING SYS                      02879
         TM    0(R3),X'40'  PCP                                         02880
         BNO   *+10                                                     02881
         MVC   BUF+42(4),=C'PCP '                                       02882
         TM    0(R3),X'20'  MFT                                         02883
         BNO   *+10                                                     02884
         MVC   BUF+42(4),=C'MFT '                                       02885
         TM    0(R3),X'10'  MVT                                         02886
         BNO   *+10                                                     02887
         MVC   BUF+42(4),=C'MP65'                                       02888
         TM    0(R3),X'22'  VS1                                         02889
         BNO   *+10                                                     02890
         MVC   BUF+42(4),=C'VS1 '                                       02891
         TM    0(R3),X'12'  VS2 REL 1 (SVS)                             02892
         BNO   *+10                                                     02893
         MVC   BUF+42(4),=C'SVS '                                       02894
         TM    0(R3),X'11'  VS2 REL 2+  (MVS)                           02895
         BNO   *+10                                                     02896
         MVC   BUF+42(4),=C'MVS '                                       02897
         BAL   R14,PRINT                                                02898
         B     NEXTVOL                                                  02899
PRTINFOL EQU   *                                                   JM#1 02900
         DC    C'***********  EXECUTION  PARM  VALUES  ************'    02901
         DC    C'*   MAP......PRODUCE A TRACK MAP OF VOLUME       *'    02902
         DC    C'*   PDS......LIST ALL PDS DIRECTORIES ON VOLUME  *'    02903
         DC    C'*   ISAM.....LIST ISAM REORG INFO FOR DATASETS   *'    02904
         DC    C'*   EXT......LIST THE EXTENTS OF THE DATASETS    *'    02905
         DC    C'*   DUMP.....LIST (HEX) ALL DSCB''S ON VOLUME     *'   02906
         DC    C'*   EMPTY....LIST ONLY DATASETS THAT ARE EMPTY   *'    02907
         DC    C'*   MODEL....WILL ONLY LIST "MODEL DSCB''S"       *'   02908
         DC    C'*   SDUMP....LIST (HEX) FORMAT 4 AND 5 DSCB''S    *'   02909
         DC    C'*   VOLS.....ONLY USE DDNAMES OF "VOLUME--",     *'    02910
         DC    C'*       FORMAT--"VOLS=X", WHERE "X" IS MAX #     *'    02911
         DC    C'*   JDATE....LIST CREATE/EXPIRE DATE IN JULIAN   *'    02912
         DC    C'*   NCP......NUMBER OF CH.PGMS. TO READ VTOC     *'    02913
         DC    C'*   LINECNT..USE OTHER THAN DEFAULT LINES/PAGE   *'    02914
         DC    C'*   LSTDT....DISPLAY LASTUSE DATE AND USECNT     *'    02915
         DC    C'*                                                *'    02916
         DC    C'**  ALL DASD ALLOCATED TO STEP WILL BE LISTED   **'    02917
         DC    C'**   EXCEPT SYSTEM DD''S...SYS--, STEP--, ETC.   **'   02918
         DC    C'*******  DO NOT USE A DDNAME OF "SYS000"  ********'    02919
PRTINFND EQU   *                                                   JM#1 02920
PRTINFLN EQU   (PRTINFND-PRTINFOL)/50                              JM#1 02921
         EJECT                                                          02922
         SPACE 3                                                        02923
PARMPARS SR    R0,R0                                                    02924
         MVC   PARMBUF,=CL8' '                                          02925
         LA    R4,PARMBUF                                               02926
         SPACE 1                                                        02927
PRMLOOK  CH    R3,=H'0'                                                 02928
         BNHR  R14                                                      02929
         CLI   0(R2),C' '                                               02930
         BE    PRMIGNOR                                                 02931
         CLI   0(R2),C','                                               02932
         BE    PRMRETRN                                                 02933
         CLI   0(R2),C'='                                               02934
         BE    PRMRETRN                                                 02935
         LTR   R0,R0                                                    02936
         BM    PRMNOT#                                                  02937
         TM    0(R2),X'F0'                                              02938
         BNO   PRMNOT#                                                  02939
         IC    R15,0(R2)                                                02940
         N     R15,=F'15'                                               02941
         CH    R15,=H'10'                                               02942
         BNL   PRMNOT#                                                  02943
         MH    R0,=H'10'                                                02944
         AR    R0,R15                                                   02945
         B     PRMSHIFT                                                 02946
         SPACE 1                                                        02947
PRMNOT#  LH    R0,=H'-1'                                                02948
PRMSHIFT C     R4,=A(PARMBUF+L'PARMBUF)                                 02949
         BNL   PRMIGNOR                                                 02950
         MVC   0(1,R4),0(R2)                                            02951
         LA    R4,1(R4)                                                 02952
PRMIGNOR LA    R2,1(R2)                                                 02953
         BCTR  R3,0                                                     02954
         B     PRMLOOK                                                  02955
         SPACE 1                                                        02956
PRMRETRN LA    R2,1(R2)                                                 02957
         BCTR  R3,0                                                     02958
         BR    R14                                                      02959
         EJECT ,                                                        02960
         SPACE 3                                                        02961
PARMS    DS    0H                                                       02962
         DC    C'LINECNT ',AL1(LNCNTOPT),AL1(1),S(PARMSET)              02963
         DC    C'NCP     ',AL1(NCPOPT),AL1(1),S(PARMSET)                02964
         DC    C'MODEL   ',AL1(MODELOPT),AL1(1),S(PARMSET)              02965
         DC    C'VOLS    ',AL1(VOLSOPT),AL1(1),S(PARMSET)               02966
         DC    C'EMPTY   ',AL1(EMPTYOPT),AL1(0),S(PARMSET)              02967
         DC    C'NOEMPTY ',AL1(255-EMPTYOPT),AL1(0),S(PARMSET)          02968
         DC    C'DEBUG   ',AL1(DEBUGOPT),AL1(1),S(DEBUGON)              02969
         DC    C'NODEBUG ',AL1(255-DEBUGOPT),AL1(1),S(DEBUGOFF)         02970
         DC    C'DUMP    ',AL1(DUMPOPT),AL1(0),S(PARMSET)               02971
         DC    C'NODUMP  ',AL1(255-DUMPOPT),AL1(0),S(PARMSET)           02972
         DC    C'EXT     ',AL1(EXTNTOPT),AL1(0),S(PARMSET)              02973
         DC    C'NOEXT   ',AL1(255-EXTNTOPT),AL1(0),S(PARMSET)          02974
         DC    C'ISAM    ',AL1(ISAMOPT),AL1(1),S(PARMSET)               02975
         DC    C'NOISAM  ',AL1(255-ISAMOPT),AL1(1),S(PARMSET)           02976
         DC    C'JDATE   ',AL1(JDATEOPT),AL1(1),S(PARMSET)              02977
         DC    C'NOJDATE ',AL1(255-JDATEOPT),AL1(1),S(PARMSET)          02978
         DC    C'LSTDT   ',AL1(LSTDTOPT),AL1(0),S(PARMSET)              02979
         DC    C'NOLSTDT ',AL1(255-LSTDTOPT),AL1(0),S(PARMSET)          02980
         DC    C'MAP     ',AL1(MAPOPT),AL1(0),S(PARMSET)                02981
         DC    C'NOMAP   ',AL1(255-MAPOPT),AL1(0),S(PARMSET)            02982
         DC    C'PDS     ',AL1(PDSOPT),AL1(0),S(PDSON)                  02983
         DC    C'NOPDS   ',AL1(255-PDSOPT),AL1(0),S(PARMSET)            02984
         DC    C'RESET   ',AL1(RESETOPT),AL1(1),S(RESETON)              02985
         DC    C'NORESET ',AL1(255-RESETOPT),AL1(1),S(RESETOFF)         02986
         DC    C'SDUMP   ',AL1(SDUMPOPT),AL1(0),S(PARMSET)              02987
         DC    C'NOSDUMP ',AL1(255-SDUMPOPT),AL1(0),S(PARMSET)          02988
PARMBUF  DC    C'        ',AL1(0),AL1(0),S(PARMERR)                     02989
         SPACE 1                                                        02990
PARMVALS DS    XL2                                                      02991
         EJECT ,                                                        02992
         LTORG                                                          02993
         SPACE 1                                                        02994
         ORG   ,                                                        02995
         EJECT                                                          02996
UCB      DSECT                                                          02997
         IEFUCBOB                                                       02998
         EJECT                                                          02999
TIOT     DSECT                                                          03000
         IEFTIOT1                                                       03001
         EJECT                                                          03002
         SPACE 3                                                        03003
         DCBD  DSORG=BS,DEVD=DA                                         03004
         EJECT                                                          03005
         SPACE 3                                                        03006
DS1      DSECT                                                          03007
         IECSDSL1 (1)                                                   03008
DS1FDAD  DS    XL8                 FULL DA ADDRESS OF F1 DSCB           03009
DS1F3PTR DS    A                   @ OF F3 DSCB, IF ANY                 03010
DS1F1PTR DS    A                   @ OF NEXT F1 DSCB                    03011
DS1LEN   EQU   *-DS1                                                    03012
         SPACE 1                                                        03013
         ORG   DS1SYSCD-1                                               03014
DS1SECLV DS    XL1                                                      03015
         ORG   DS1SYSCD+13                                              03016
DS1LSTDT DS    XL3                                                      03017
DS1USCNT DS    XL2                                                      03018
         EJECT ,                                                        03019
         SPACE 3                                                        03020
DS2      DSECT                                                          03021
         IECSDSL1 (2)                                                   03022
DS2FDAD  DS    XL8                 FULL DA ADDRESS OF F2 DSCB           03023
DS2F3PTR DS    A                   POINTER TO FMT3 DSCB, IF ANY         03024
DS2LEN   EQU   *-DS2                                                    03025
         EJECT                                                          03026
         SPACE 3                                                        03027
DS3      DSECT                                                          03028
         IECSDSL1 (3)                                                   03029
DS3FDAD  DS    XL8                 FULL DA ADDRESS OF F3 DSCB           03030
DS3F2PTR DS    A                   POINTER TO FMT2 DSCB, IF ANY         03031
DS3LEN   EQU   *-DS3                                                    03032
         EJECT                                                          03033
         SPACE 3                                                        03034
DS4      DSECT                                                          03035
DS4KEYID DS    XL44                                                     03036
         IECSDSL1 (4)                                                   03037
DS4FDAD  DS    XL8                                                      03038
DS4LEN   EQU   *-DS4                                                    03039
*                                                                       03040
         ORG   DS4NOEXT+2                                               03041
DS4SECLV DS    XL1                 PRIV LEVEL REQ. FOR VTOC ACCESS      03042
         ORG   DS4DEVDB+9          VSAM OWNERSHIP BIT  X'80'            03043
DS4VSAM  DS    XL1                 USED TO PREVENT MULTIPLE OWNERS      03044
         EJECT                                                          03045
         SPACE 3                                                        03046
DS5      DSECT                                                          03047
         IECSDSL1 (5)                                                   03048
DS5FDAD  DS    XL8                                                      03049
DS5F5PTR DS    A                   @ OF NEXT F5 DSCB, IF ANY            03050
DS5LEN   EQU   *-DS5                                                    03051
         EJECT                                                          03052
         SPACE 3                                                        03053
DS6      DSECT                                                          03054
         IECSDSL1 (6)                                                   03055
DS6FDAD  DS    XL8                                                      03056
DS6F6PTR DS    A                                                        03057
DS6LEN   EQU   *-DS6                                                    03058
         EJECT                                                          03059
         SPACE 3                                                        03060
COM      DSECT                                                          03061
         IEZCOM                                                         03062
         EJECT ,                                                        03063
         SPACE 3                                                        03064
CIB      DSECT                                                          03065
         IEZCIB                                                         03066
         EJECT                                                          03067
         SPACE 1                                                        03068
EXTENT   DSECT                                                          03069
EXTPTR   DS    A                                                        03070
EXTLCCHH DS    XL4                                                      03071
EXTHCCHH DS    XL4                                                      03072
EXTNOTRK DS    H                                                        03073
EXTTYPE  DS    X                                                        03074
EXTSEQNO DS    X                                                        03075
EXTIDPTR DS    A                                                        03076
EXTLOTT  DS    XL2                                                      03077
EXTHITT  DS    XL2                                                      03078
EXTNTLEN EQU   *-EXTENT                                                 03079
         SPACE 1                                                        03080
EXLINE   DSECT                                                          03081
EXLLPARN DS    C                                                        03082
EXLFCC   DS    CL4                                                      03083
EXLFPRD  DS    C                                                        03084
EXLFHH   DS    CL4                                                      03085
         DS    2C                                                       03086
EXLLCC   DS    CL4                                                      03087
EXLLPRD  DS    C                                                        03088
EXLLHH   DS    CL4                                                      03089
         DS    2C                                                       03090
EXLFTT   DS    CL5                                                      03091
         DS    2C                                                       03092
EXLLTT   DS    CL5                                                      03093
         DS    2C                                                       03094
EXLNOTRK DS    CL5                                                      03095
EXLRPARN DS    C                                                        03096
         DS    C                                                        03097
EXLSEQNO DS    CL2                                                      03098
         DS    2C                                                       03099
EXLTYPE  DS    CL4                                                      03100
         DS    2C                                                       03101
EXLDSNAM DS    CL44                                                     03102
EXLSPLIT EQU   EXLDSNAM+33                                              03103
         SPACE 1                                                        03104
PDS      DSECT                                                          03105
PDSHKEY  DS    CL8                                                      03106
PDSCOUNT DS    H                                                        03107
         SPACE 1                                                        03108
PDSENTRY EQU   *                                                        03109
PDSNAME  DS    CL8                                                      03110
PDSTTRP  DS    XL3                                                      03111
PDSINDIC DS    B                                                        03112
PDSALIAS EQU   X'80'                                                    03113
PDS#TTRS EQU   X'60'                                                    03114
PDSUSERH EQU   X'1F'                                                    03115
PDSUSERD DS    0X                                                       03116
         SPACE 3                                                        03117
         END   DISKMAP            BROTHER, YOU ASKED FOR IT             03118
